/*
@license
dhtmlxScheduler v.5.1.6 Professional
This software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.
(c) Dinamenta, UAB.
*/
function dtmlXMLLoaderObject(n,t,i,r){return this.xmlDoc="",this.async=typeof i!="undefined"?i:!0,this.onloadAction=n||null,this.mainObject=t||null,this.waitCall=null,this.rSeed=r||!1,this}function convertStringToBoolean(n){typeof n=="string"&&(n=n.toLowerCase());switch(n){case"1":case"true":case"yes":case"y":case 1:case!0:return!0;default:return!1}}function getUrlSymbol(n){return n.indexOf("?")!=-1?"&":"?"}function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function _dhtmlxError(){return this.catches||(this.catches=[]),this}function dhtmlXHeir(n,t){for(var i in t)typeof t[i]=="function"&&(n[i]=t[i]);return n}window.dhtmlXScheduler=window.scheduler={version:"5.1.6"};window.dhtmlx||(dhtmlx=function(n){for(var t in n)dhtmlx[t]=n[t];return dhtmlx});dhtmlx.extend_api=function(n,t,i){var r=window[n];r&&(window[n]=function(n){var u,i;if(n&&typeof n=="object"&&!n.tagName){u=r.apply(this,t._init?t._init(n):arguments);for(i in dhtmlx)t[i]&&this[t[i]](dhtmlx[i]);for(i in n)t[i]?this[t[i]](n[i]):i.indexOf("on")===0&&this.attachEvent(i,n[i])}else u=r.apply(this,arguments);return t._patch&&t._patch(this),u||this},window[n].prototype=r.prototype,i&&dhtmlXHeir(window[n].prototype,i))};dhtmlxAjax={get:function(n,t){var i=new dtmlXMLLoaderObject(!0);return i.async=arguments.length<3,i.waitCall=t,i.loadXML(n),i},post:function(n,t,i){var r=new dtmlXMLLoaderObject(!0);return r.async=arguments.length<4,r.waitCall=i,r.loadXML(n,!0,t),r},getSync:function(n){return this.get(n,null,!0)},postSync:function(n,t){return this.post(n,t,null,!0)}};window.dtmlXMLLoaderObject=dtmlXMLLoaderObject;dtmlXMLLoaderObject.count=0;dtmlXMLLoaderObject.prototype.waitLoadFunction=function(n){var t=!0;return this.check=function(){if(n&&n.onloadAction&&(!n.xmlDoc.readyState||n.xmlDoc.readyState==4)){if(!t)return;if(t=!1,dtmlXMLLoaderObject.count++,typeof n.onloadAction=="function")n.onloadAction(n.mainObject,null,null,null,n);n.waitCall&&(n.waitCall.call(this,n),n.waitCall=null)}},this.check};dtmlXMLLoaderObject.prototype.getXMLTopNode=function(n,t){var i,r,t;return(this.xmlDoc.responseXML?(r=this.xmlDoc.responseXML.getElementsByTagName(n),r.length===0&&n.indexOf(":")!=-1&&(r=this.xmlDoc.responseXML.getElementsByTagName(n.split(":")[1])),i=r[0]):i=this.xmlDoc.documentElement,i)?(this._retry=!1,i):!this._retry&&_isIE?(this._retry=!0,t=this.xmlDoc,this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),!0),this.getXMLTopNode(n,t)):(dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),document.createElement("div"))};dtmlXMLLoaderObject.prototype.loadXMLString=function(n,t){if(_isIE)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(n);else{var i=new DOMParser;this.xmlDoc=i.parseFromString(n,"text/xml")}if(!t){if(this.onloadAction)this.onloadAction(this.mainObject,null,null,null,this);this.waitCall&&(this.waitCall(),this.waitCall=null)}};dtmlXMLLoaderObject.prototype.loadXML=function(n,t,i,r){this.rSeed&&(n+=(n.indexOf("?")!=-1?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf());this.filePath=n;this.xmlDoc=!_isIE&&window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.async&&(this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this));typeof t=="string"?this.xmlDoc.open(t,n,this.async):this.xmlDoc.open(t?"POST":"GET",n,this.async);r?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type","text/xml")):t&&this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded");this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(null||i);this.async||new this.waitLoadFunction(this)()};dtmlXMLLoaderObject.prototype.destructor=function(){return this._filterXPath=null,this._getAllNamedChilds=null,this._retry=null,this.async=null,this.rSeed=null,this.filePath=null,this.onloadAction=null,this.mainObject=null,this.xmlDoc=null,this.doXPath=null,this.doXPathOpera=null,this.doXSLTransToObject=null,this.doXSLTransToString=null,this.loadXML=null,this.loadXMLString=null,this.doSerialization=null,this.xmlNodeToJSON=null,this.getXMLTopNode=null,this.setXSLParamValue=null,null};dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(n){for(var r,i={},t=0;t<n.attributes.length;t++)i[n.attributes[t].name]=n.attributes[t].value;for(i._tagvalue=n.firstChild?n.firstChild.nodeValue:"",t=0;t<n.childNodes.length;t++)r=n.childNodes[t].tagName,r&&(i[r]||(i[r]=[]),i[r].push(this.xmlNodeToJSON(n.childNodes[t])));return i};window.dhtmlDragAndDropObject=dhtmlDragAndDropObject;dhtmlDragAndDropObject.prototype.removeDraggableItem=function(n){n.onmousedown=null;n.dragStarter=null;n.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(n,t){n.onmousedown=this.preCreateDragCopy;n.dragStarter=t;this.addDragLanding(n,t)};dhtmlDragAndDropObject.prototype.addDragLanding=function(n,t){n.dragLanding=t};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(n){if(!(n||window.event)||(n||event).button!=2)return window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(n),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),n&&n.preventDefault)?(n.preventDefault(),!1):!1};dhtmlDragAndDropObject.prototype.callDrag=function(n){var t,i,u,r,f;if(n||(n=window.event),t=window.dhtmlDragAndDrop,!((new Date).valueOf()-t.downtime<100)){if(!t.dragNode)if(t.waitDrag){if(t.dragNode=t.dragStartObject._createDragNode(t.dragStartNode,n),!t.dragNode)return t.stopDrag();t.dragNode.onselectstart=function(){return!1};t.gldragNode=t.dragNode;document.body.appendChild(t.dragNode);document.body.onmouseup=t.stopDrag;t.waitDrag=0;t.dragNode.pWindow=window;t.initFrameRoute()}else return t.stopDrag(n,!0);t.dragNode.parentNode!=window.document.body&&t.gldragNode&&(i=t.gldragNode,t.gldragNode.old&&(i=t.gldragNode.old),i.parentNode.removeChild(i),u=t.dragNode.pWindow,i.pWindow&&i.pWindow.dhtmlDragAndDrop.lastLanding&&i.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(i.pWindow.dhtmlDragAndDrop.lastLanding),_isIE?(r=document.createElement("div"),r.innerHTML=t.dragNode.outerHTML,t.dragNode=r.childNodes[0]):t.dragNode=t.dragNode.cloneNode(!0),t.dragNode.pWindow=window,t.gldragNode.old=t.dragNode,document.body.appendChild(t.dragNode),u.dhtmlDragAndDrop.dragNode=t.dragNode);t.dragNode.style.left=n.clientX+15+(t.fx?t.fx*-1:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";t.dragNode.style.top=n.clientY+3+(t.fy?t.fy*-1:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";f=n.srcElement?n.srcElement:n.target;t.checkLanding(f,n)}};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(n){var u;if(window.name){for(var t=parent.frames[window.name].frameElement.offsetParent,i=0,r=0;t;)i+=t.offsetLeft,r+=t.offsetTop,t=t.offsetParent;if(parent.dhtmlDragAndDrop&&(u=parent.dhtmlDragAndDrop.calculateFramePosition(1),i+=u.split("_")[0]*1,r+=u.split("_")[1]*1),n)return i+"_"+r;this.fx=i;this.fy=r}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(n,t){n&&n.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=n,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,t.clientX,t.clientY,t),this.lastLanding_scr=_isIE?t.srcElement:t.target):n&&n.tagName!="BODY"?this.checkLanding(n.parentNode,t):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,t.clientX,t.clientY,t),this.lastLanding=0,this._onNotFound&&this._onNotFound())};dhtmlDragAndDropObject.prototype.stopDrag=function(n,t){var i=window.dhtmlDragAndDrop,r;t||(i.stopFrameRoute(),r=i.lastLanding,i.lastLanding=null,r&&r.dragLanding._drag(i.dragStartNode,i.dragStartObject,r,_isIE?event.srcElement:n.target));i.lastLanding=null;i.dragNode&&i.dragNode.parentNode==document.body&&i.dragNode.parentNode.removeChild(i.dragNode);i.dragNode=0;i.gldragNode=0;i.fx=0;i.fy=0;i.dragStartNode=0;i.dragStartObject=0;document.body.onmouseup=i.tempDOMU;document.body.onmousemove=i.tempDOMM;i.tempDOMU=null;i.tempDOMM=null;i.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(n){n&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var t=0;t<window.frames.length;t++)try{window.frames[t]!=n&&window.frames[t].dhtmlDragAndDrop&&window.frames[t].dhtmlDragAndDrop.stopFrameRoute(window)}catch(i){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=n&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(i){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(n,t){n&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=n.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=n.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=n.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=n.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&t&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=n&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(r){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=n&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!n||t?1:0)}catch(r){}};_isFF=!1;_isIE=!1;_isOpera=!1;_isKHTML=!1;_isMacOS=!1;_isChrome=!1;_FFrv=!1;_KHTMLrv=!1;_OperaRv=!1;navigator.userAgent.indexOf("Macintosh")!=-1&&(_isMacOS=!0);navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0);navigator.userAgent.indexOf("Safari")!=-1||navigator.userAgent.indexOf("Konqueror")!=-1?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):navigator.userAgent.indexOf("Opera")!=-1?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):navigator.appName.indexOf("Microsoft")!=-1?(_isIE=!0,(navigator.appVersion.indexOf("MSIE 8.0")!=-1||navigator.appVersion.indexOf("MSIE 9.0")!=-1||navigator.appVersion.indexOf("MSIE 10.0")!=-1)&&document.compatMode!="BackCompat"&&(_isIE=8)):navigator.appName=="Netscape"&&navigator.userAgent.indexOf("Trident")!=-1?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1]));dtmlXMLLoaderObject.prototype.doXPath=function(n,t,i,r){var u,f,e,o,s;if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(n,t);if(_isIE)return t||(t=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),t||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),i&&t.setProperty("SelectionNamespaces","xmlns:xsl='"+i+"'"),r=="single"?t.selectSingleNode(n):t.selectNodes(n)||new Array(0);if(u=t,t||(t=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),t||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),t.nodeName.indexOf("document")!=-1?u=t:(u=t,t=t.ownerDocument),f=XPathResult.ANY_TYPE,r=="single"&&(f=XPathResult.FIRST_ORDERED_NODE_TYPE),e=[],o=t.evaluate(n,u,function(){return i},f,null),f==XPathResult.FIRST_ORDERED_NODE_TYPE)return o.singleNodeValue;for(s=o.iterateNext();s;)e[e.length]=s,s=o.iterateNext();return e};_dhtmlxError.prototype.catchError=function(n,t){this.catches[n]=t};_dhtmlxError.prototype.throwError=function(n,t,i){return this.catches[n]?this.catches[n](n,t,i):this.catches.ALL?this.catches.ALL(n,t,i):(window.alert("Error type: "+arguments[0]+"\nDescription: "+arguments[1]),null)};window.dhtmlxError=new _dhtmlxError;dtmlXMLLoaderObject.prototype.doXPathOpera=function(n,t){var i=n.replace(/[\/]+/gi,"/").split("/"),u=null,r=1;if(!i.length)return[];if(i[0]==".")u=[t];else if(i[0]==="")u=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(i[r].replace(/\[[^\]]*\]/g,"")),r++;else return[];for(r;r<i.length;r++)u=this._getAllNamedChilds(u,i[r]);return i[r-1].indexOf("[")!=-1&&(u=this._filterXPath(u,i[r-1])),u};dtmlXMLLoaderObject.prototype._filterXPath=function(n,t){for(var r=[],t=t.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),i=0;i<n.length;i++)n[i].getAttribute(t)&&(r[r.length]=n[i]);return r};dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(n,t){var u=[],i,r;for(_isKHTML&&(t=t.toUpperCase()),i=0;i<n.length;i++)for(r=0;r<n[i].childNodes.length;r++)_isKHTML?n[i].childNodes[r].tagName&&n[i].childNodes[r].tagName.toUpperCase()==t&&(u[u.length]=n[i].childNodes[r]):n[i].childNodes[r].tagName==t&&(u[u.length]=n[i].childNodes[r]);return u};typeof dhtmlxEvent=="undefined"&&(window.dhtmlxEvent=function(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent&&n.attachEvent("on"+t,i)});dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(n,t,i){i||(i=this.xslDoc);i.responseXML&&(i=i.responseXML);var r=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+n+"']",i,"http://www.w3.org/1999/XSL/Transform","single");r&&(r.firstChild.nodeValue=t)};dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(n,t){n||(n=this.xslDoc);n.responseXML&&(n=n.responseXML);t||(t=this.xmlDoc);t.responseXML&&(t=t.responseXML);var i;if(_isIE){i=new ActiveXObject("Msxml2.DOMDocument.3.0");try{t.transformNodeToObject(n,i)}catch(r){i=t.transformNode(n)}}else this.XSLProcessor||(this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(n)),i=this.XSLProcessor.transformToDocument(t);return i};dtmlXMLLoaderObject.prototype.doXSLTransToString=function(n,t){var i=this.doXSLTransToObject(n,t);return typeof i=="string"?i:this.doSerialization(i)};dtmlXMLLoaderObject.prototype.doSerialization=function(n){if(n||(n=this.xmlDoc),n.responseXML&&(n=n.responseXML),_isIE)return n.xml;var t=new XMLSerializer;return t.serializeToString(n)};dhtmlxEventable=function(n){n.attachEvent=function(n,t,i){return n="ev_"+n.toLowerCase(),this[n]||(this[n]=new this.eventCatcher(i||this)),n+":"+this[n].addEvent(t)};n.callEvent=function(n,t){return(n="ev_"+n.toLowerCase(),this[n])?this[n].apply(this,t):!0};n.checkEvent=function(n){return!!this["ev_"+n.toLowerCase()]};n.eventCatcher=function(n){var t=[],i=function(){for(var u,r=!0,i=0;i<t.length;i++)t[i]&&(u=t[i].apply(n,arguments),r=r&&u);return r};return i.addEvent=function(n){return(typeof n!="function"&&(n=eval(n)),n)?t.push(n)-1:!1},i.removeEvent=function(n){t[n]=null},i};n.detachEvent=function(n){if(n){var t=n.split(":");this[t[0]].removeEvent(t[1])}};n.detachAllEvents=function(){for(var n in this)n.indexOf("ev_")===0&&(this.detachEvent(n),this[n]=null)};n=null};window.dhtmlx||(window.dhtmlx={}),function(){function u(n,r){setTimeout(function(){if(n.box){var u=n.callback;t(!1);n.box.parentNode.removeChild(n.box);dhtmlx.callEvent("onAfterMessagePopup",[n.box]);i=n.box=null;u&&u(r)}},1)}function r(n){var t,r,f;if(i)return(n=n||event,t=n.which||event.keyCode,r=!1,dhtmlx.message.keyboard&&((t==13||t==32)&&(f=n.target||n.srcElement,scheduler._getClassName(f).indexOf("dhtmlx_popup_button")>-1&&f.click?f.click():(u(i,!0),r=!0)),t==27&&(u(i,!1),r=!0)),r)?(n.preventDefault&&n.preventDefault(),!(n.cancelBubble=!0)):void 0}function t(n){t.cover||(t.cover=document.createElement("div"),t.cover.onkeydown=r,t.cover.className="dhx_modal_cover",document.body.appendChild(t.cover));var i=document.body.scrollHeight;t.cover.style.display=n?"inline-block":"none"}function f(n,t,i){var r=scheduler._waiAria.messageButtonAttrString(n),u=i?i:n||"",f="dhtmlx_"+u.toLowerCase().replace(/ /g,"_")+"_button";return"<div "+r+"class='dhtmlx_popup_button "+f+"' result='"+t+"' ><div>"+n+"<\/div><\/div>"}function l(t){n.area||(n.area=document.createElement("div"),n.area.className="dhtmlx_message_area",n.area.style[n.position]="5px",document.body.appendChild(n.area));n.hide(t.id);var i=document.createElement("div");return i.innerHTML="<div>"+t.text+"<\/div>",i.className="dhtmlx-info dhtmlx-"+t.type,i.onclick=function(){n.hide(t.id);t=null},scheduler._waiAria.messageInfoAttr(i),n.position=="bottom"&&n.area.firstChild?n.area.insertBefore(i,n.area.firstChild):n.area.appendChild(i),t.expire>0&&(n.timers[t.id]=window.setTimeout(function(){n.hide(t.id)},t.expire)),n.pull[t.id]=i,i=null,t.id}function a(n,t,r){var e=document.createElement("div"),c,o,v,l,a,h,s;if(e.className=" dhtmlx_modal_box dhtmlx-"+n.type,e.setAttribute("dhxbox",1),c=scheduler.uid(),scheduler._waiAria.messageModalAttr(e,c),o="",v=!1,n.width&&(e.style.width=n.width),n.height&&(e.style.height=n.height),n.title&&(o+='<div class="dhtmlx_popup_title" id="'+c+'">'+n.title+"<\/div>",v=!0),o+='<div class="dhtmlx_popup_text" '+(v?"":' id="'+c+'" ')+"><span>"+(n.content?"":n.text)+'<\/span><\/div><div  class="dhtmlx_popup_controls">',t&&(l=n.ok||scheduler.locale.labels.message_ok,l===undefined&&(l="OK"),o+=f(l,!0,"ok")),r&&(a=n.cancel||scheduler.locale.labels.message_cancel,a===undefined&&(a="Cancel"),o+=f(a,!1,"cancel")),n.buttons)for(h=0;h<n.buttons.length;h++)o+=f(n.buttons[h],h);return o+="<\/div>",e.innerHTML=o,n.content&&(s=n.content,typeof s=="string"&&(s=document.getElementById(s)),s.style.display=="none"&&(s.style.display=""),e.childNodes[n.title?1:0].appendChild(s)),e.onclick=function(t){var i,f,r;t=t||event;i=t.target||t.srcElement;f=scheduler._getClassName(i);f||(i=i.parentNode);f=scheduler._getClassName(i);f.split(" ")[0]=="dhtmlx_popup_button"&&(r=i.getAttribute("result"),r=r=="true"||(r=="false"?!1:r),u(n,r))},n.box=e,i=n,e}function e(n,i,u){var f=n.tagName?n:a(n,i,u),e,o;return n.hidden||t(!0),document.body.appendChild(f),e=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-f.offsetWidth)/2)),o=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-f.offsetHeight)/2)),f.style.top=n.position=="top"?"-3px":o+"px",f.style.left=e+"px",f.onkeydown=r,dhtmlx.modalbox.focus(f),n.hidden&&dhtmlx.modalbox.hide(f),dhtmlx.callEvent("onMessagePopup",[f]),f}function s(n){return e(n,!0,!1)}function h(n){return e(n,!0,!0)}function c(n){return e(n)}function o(n,t,i){return typeof n!="object"&&(typeof t=="function"&&(i=t,t=""),n={text:n,type:t,callback:i}),n}function v(t,i,r,u){return typeof t!="object"&&(t={text:t,type:i,expire:r,id:u}),t.id=t.id||n.uid(),t.expire=t.expire||n.expire,t}var i=null,n;document.attachEvent?document.attachEvent("onkeydown",r):document.addEventListener("keydown",r,!0);dhtmlx.alert=function(){var n=o.apply(this,arguments);return n.type=n.type||"confirm",s(n)};dhtmlx.confirm=function(){var n=o.apply(this,arguments);return n.type=n.type||"alert",h(n)};dhtmlx.modalbox=function(){var n=o.apply(this,arguments);return n.type=n.type||"alert",c(n)};dhtmlx.modalbox.hide=function(n){while(n&&n.getAttribute&&!n.getAttribute("dhxbox"))n=n.parentNode;n&&(n.parentNode.removeChild(n),t(!1))};dhtmlx.modalbox.focus=function(n){setTimeout(function(){var t=scheduler._getFocusableNodes(n);t.length&&t[0].focus&&t[0].focus()},1)};n=dhtmlx.message=function(n){n=v.apply(this,arguments);n.type=n.type||"info";var t=n.type.split("-")[0];switch(t){case"alert":return s(n);case"confirm":return h(n);case"modalbox":return c(n);default:return l(n)}};n.seed=(new Date).valueOf();n.uid=function(){return n.seed++};n.expire=4e3;n.keyboard=!0;n.position="top";n.pull={};n.timers={};n.hideAll=function(){for(var t in n.pull)n.hide(t)};n.hide=function(t){var i=n.pull[t];i&&i.parentNode&&(window.setTimeout(function(){i.parentNode.removeChild(i);i=null},2e3),i.className+=" hidden",n.timers[t]&&window.clearTimeout(n.timers[t]),delete n.pull[t])}}();dhtmlx.attachEvent||dhtmlxEventable(dhtmlx);var dataProcessor=window.dataProcessor=function(n){return this.serverProcessor=n,this.action_param="!nativeeditor_status",this.object=null,this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._tMode="GET",this._headers=null,this._payload=null,this.post_delim="_",this._waitMode=0,this._in_progress={},this._invalid={},this.mandatoryFields=[],this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),dhtmlxEventable(this),this};dataProcessor.prototype={setTransactionMode:function(n,t){typeof n=="object"?(this._tMode=n.mode||this._tMode,n.headers!==undefined&&(this._headers=n.headers),n.payload!==undefined&&(this._payload=n.payload)):(this._tMode=n,this._tSend=t);this._tMode=="REST"&&(this._tSend=!1,this._endnm=!0);this._tMode=="JSON"&&(this._tSend=!1,this._endnm=!0,this._headers=this._headers||{},this._headers["Content-type"]="application/json")},escape:function(n){return this._utf?encodeURIComponent(n):escape(n)},enableUTFencoding:function(n){this._utf=!!n},setDataColumns:function(n){this._columns=typeof n=="string"?n.split(","):n},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(n){this._endnm=!!n},enablePartialDataSend:function(n){this._changed=!!n},setUpdateMode:function(n,t){this.autoUpdate=n=="cell";this.updateMode=n;this.dnd=t},ignore:function(n,t){this._silent_mode=!0;n.call(t||window);this._silent_mode=!1},setUpdated:function(n,t,i){var r,u;this._silent_mode||(r=this.findRow(n),i=i||"updated",u=this.obj.getUserData(n,this.action_param),u&&i=="updated"&&(i=u),t?(this.set_invalid(n,!1),this.updatedRows[r]=n,this.obj.setUserData(n,this.action_param,i),this._in_progress[n]&&(this._in_progress[n]="wait")):this.is_invalid(n)||(this.updatedRows.splice(r,1),this.obj.setUserData(n,this.action_param,"")),t||this._clearUpdateFlag(n),this.markRow(n,t,i),t&&this.autoUpdate&&this.sendData(n))},_clearUpdateFlag:function(){},markRow:function(n,t,i){var u="",r=this.is_invalid(n),f;if(r&&(u=this.styles[r],t=!0),this.callEvent("onRowMark",[n,t,i,r])&&(u=this.styles[t?i:"clear"]+u,this.obj[this._methods[0]](n,u),r&&r.details))for(u+=this.styles[r+"_cell"],f=0;f<r.details.length;f++)r.details[f]&&this.obj[this._methods[1]](n,f,u)},getState:function(n){return this.obj.getUserData(n,this.action_param)},is_invalid:function(n){return this._invalid[n]},set_invalid:function(n,t,i){i&&(t={value:t,details:i,toString:function(){return this.value.toString()}});this._invalid[n]=t},checkBeforeUpdate:function(){return!0},sendData:function(n){if(!this._waitMode||this.obj.mytype!="tree"&&!this.obj._h2){if(this.obj.editStop&&this.obj.editStop(),typeof n=="undefined"||this._tSend)return this.sendAllData();if(this._in_progress[n]||(this.messages=[],!this.checkBeforeUpdate(n)&&this.callEvent("onValidationError",[n,this.messages])))return!1;this._beforeSendData(this._getRowData(n),n)}},_beforeSendData:function(n,t){if(!this.callEvent("onBeforeUpdate",[t,this.getState(t),n]))return!1;this._sendData(n,t)},serialize:function(n,t){var i,u,r;if(typeof n=="string")return n;if(typeof t!="undefined")return this.serialize_one(n,"");i=[];u=[];for(r in n)n.hasOwnProperty(r)&&(i.push(this.serialize_one(n[r],r+this.post_delim)),u.push(r));return i.push("ids="+this.escape(u.join(","))),dhtmlx.security_key&&i.push("dhx_security="+dhtmlx.security_key),i.join("&")},serialize_one:function(n,t){var r,i;if(typeof n=="string")return n;r=[];for(i in n)if(n.hasOwnProperty(i)){if((i=="id"||i==this.action_param)&&this._tMode=="REST")continue;r.push(this.escape((t||"")+i)+"="+this.escape(n[i]))}return r.join("&")},_applyPayload:function(n){var i=this.obj.$ajax,t;if(this._payload)for(t in this._payload)n=n+i.urlSeparator(n)+this.escape(t)+"="+this.escape(this._payload[t]);return n},_sendData:function(n,t){var l,i,o;if(n){if(!this.callEvent("onBeforeDataSending",t?[t,this.getState(t),n]:[null,null,n]))return!1;t&&(this._in_progress[t]=(new Date).valueOf());var h=this,f=function(i){var r=[],u;if(t)r.push(t);else if(n)for(u in n)r.push(u);return h.afterUpdate(h,i,r)},u=this.obj.$ajax,c=this.serverProcessor+(this._user?u.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&"):""),e=this._applyPayload(c);if(this._tMode=="GET")u.query({url:e+u.urlSeparator(e)+this.serialize(n,t),method:"GET",callback:f,headers:this._headers});else if(this._tMode=="POST")u.query({url:e,method:"POST",headers:this._headers,data:this.serialize(n,t),callback:f});else if(this._tMode=="JSON"){l=n[this.action_param];i={};for(o in n)i[o]=n[o];delete i[this.action_param];delete i.id;delete i.gr_id;u.query({url:e,method:"POST",headers:this._headers,callback:f,data:JSON.stringify({id:t,action:l,data:i})})}else if(this._tMode=="REST"){var a=this.getState(t),r=c.replace(/(\&|\?)editing\=true/,""),i="",s="post";a=="inserted"?i=this.serialize(n,t):a=="deleted"?(s="DELETE",r=r+(r.slice(-1)=="/"?"":"/")+t):(s="PUT",i=this.serialize(n,t),r=r+(r.slice(-1)=="/"?"":"/")+t);r=this._applyPayload(r);u.query({url:r,method:s,headers:this._headers,data:i,callback:f})}this._waitMode++}},sendAllData:function(){var t,n;if(this.updatedRows.length){for(this.messages=[],t=!0,n=0;n<this.updatedRows.length;n++)t&=this.checkBeforeUpdate(this.updatedRows[n]);if(!t&&!this.callEvent("onValidationError",["",this.messages]))return!1;if(this._tSend)this._sendData(this._getAllData());else for(n=0;n<this.updatedRows.length;n++)if(!this._in_progress[this.updatedRows[n]]){if(this.is_invalid(this.updatedRows[n]))continue;if(this._beforeSendData(this._getRowData(this.updatedRows[n]),this.updatedRows[n]),this._waitMode&&(this.obj.mytype=="tree"||this.obj._h2))return}}},_getAllData:function(){for(var n,i,r={},u=!1,t=0;t<this.updatedRows.length;t++)(n=this.updatedRows[t],this._in_progress[n]||this.is_invalid(n))||(i=this._getRowData(n),this.callEvent("onBeforeUpdate",[n,this.getState(n),i]))&&(r[n]=i,u=!0,this._in_progress[n]=(new Date).valueOf());return u?r:null},setVerificator:function(n,t){this.mandatoryFields[n]=t||function(n){return n!==""}},clearVerificator:function(n){this.mandatoryFields[n]=!1},findRow:function(n){for(var t=0,t=0;t<this.updatedRows.length;t++)if(n==this.updatedRows[t])break;return t},defineAction:function(n,t){this._uActions||(this._uActions=[]);this._uActions[n]=t},afterUpdateCallback:function(n,t,i,r){var u=n,f=i!="error"&&i!="invalid",e;if(f||this.set_invalid(n,i),this._uActions&&this._uActions[i]&&!this._uActions[i](r))return delete this._in_progress[u];this._in_progress[u]!="wait"&&this.setUpdated(n,!1);e=n;switch(i){case"inserted":case"insert":t!=n&&(this.setUpdated(n,!1),this.obj[this._methods[2]](n,t),n=t);break;case"delete":case"deleted":return this.obj.setUserData(n,this.action_param,"true_deleted"),this.obj[this._methods[3]](n,t),delete this._in_progress[u],this.callEvent("onAfterUpdate",[n,i,t,r])}this._in_progress[u]!="wait"?(f&&this.obj.setUserData(n,this.action_param,""),delete this._in_progress[u]):(delete this._in_progress[u],this.setUpdated(t,!0,this.obj.getUserData(n,this.action_param)));this.callEvent("onAfterUpdate",[e,i,t,r])},_errorResponse:function(n,t){return this.obj&&this.obj.callEvent&&this.obj.callEvent("onSaveError",[t,n.xmlDoc]),this.cleanUpdate(t)},afterUpdate:function(n,t,i){var s=this.obj.$ajax,r,o,u,f;if(t.xmlDoc.status!==200){this._errorResponse(t,i);return}if(window.JSON){try{r=JSON.parse(t.xmlDoc.responseText)}catch(a){t.xmlDoc.responseText.length||(r={})}if(r){var h=r.action||this.getState(i)||"updated",c=r.sid||i[0],l=r.tid||i[0];n.afterUpdateCallback(c,l,h,r);n.finalizeUpdate();return}}if(o=s.xmltop("data",t.xmlDoc),!o)return this._errorResponse(t,i);for(u=s.xpath("//data/action",o),u.length||this._errorResponse(t,i),f=0;f<u.length;f++){var e=u[f],h=e.getAttribute("type"),c=e.getAttribute("sid"),l=e.getAttribute("tid");n.afterUpdateCallback(c,l,h,e)}n.finalizeUpdate()},cleanUpdate:function(n){if(n)for(var t=0;t<n.length;t++)delete this._in_progress[n[t]]},finalizeUpdate:function(){this._waitMode&&this._waitMode--;(this.obj.mytype=="tree"||this.obj._h2)&&this.updatedRows.length&&this.sendData();this.callEvent("onAfterUpdateFinish",[]);this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(n){this.obj=n;this.obj._dp_init&&this.obj._dp_init(this)},setOnAfterUpdate:function(n){this.attachEvent("onAfterUpdate",n)},enableDebug:function(){},setOnBeforeUpdateHandler:function(n){this.attachEvent("onBeforeDataSending",n)},setAutoUpdate:function(n,t){n=n||2e3;this._user=t||(new Date).valueOf();this._need_update=!1;this._update_busy=!1;this.attachEvent("onAfterUpdate",function(n,t,i,r){this.afterAutoUpdate(n,t,i,r)});this.attachEvent("onFullSync",function(){this.fullSync()});var i=this;window.setInterval(function(){i.loadUpdate()},n)},afterAutoUpdate:function(n,t){return t=="collision"?(this._need_update=!0,!1):!0},fullSync:function(){return this._need_update&&(this._need_update=!1,this.loadUpdate()),!0},getUpdates:function(n,t){var i=this.obj.$ajax;if(this._update_busy)return!1;this._update_busy=!0;i.get(n,t)},_v:function(n){return n.firstChild?n.firstChild.nodeValue:""},_a:function(n){for(var i=[],t=0;t<n.length;t++)i[t]=this._v(n[t]);return i},loadUpdate:function(){var t=this.obj.$ajax,n=this,r=this.obj.getUserData(0,"version"),i=this.serverProcessor+t.urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+r].join("&");i=i.replace("editing=true&","");this.getUpdates(i,function(i){var o=t.xpath("//userdata",i),r,u;if(n.obj.setUserData(0,"version",n._v(o[0])),r=t.xpath("//update",i),r.length){for(n._silent_mode=!0,u=0;u<r.length;u++){var s=r[u].getAttribute("status"),f=r[u].getAttribute("id"),e=r[u].getAttribute("parent");switch(s){case"inserted":n.callEvent("insertCallback",[r[u],f,e]);break;case"updated":n.callEvent("updateCallback",[r[u],f,e]);break;case"deleted":n.callEvent("deleteCallback",[r[u],f,e])}}n._silent_mode=!1}n._update_busy=!1;n=null})}};window.dataProcessor&&!dataProcessor.prototype.init_original&&(dataProcessor.prototype.init_original=dataProcessor.prototype.init,dataProcessor.prototype.init=function(n){this.init_original(n);n._dataprocessor=this;this.setTransactionMode("POST",!0);this.serverProcessor+=(this.serverProcessor.indexOf("?")!=-1?"&":"?")+"editing=true"});dhtmlxError.catchError("LoadXML",function(n,t,i){var r=i[0].responseText;switch(scheduler.config.ajax_error){case"alert":window.alert(r);break;case"console":window.console.log(r)}});window.Scheduler={_seed:0};Scheduler.plugin=function(n){this._schedulerPlugins.push(n);n(window.scheduler)};Scheduler._schedulerPlugins=[];Scheduler.getSchedulerInstance=function(){var n={version:"5.1.6"},t;for(dhtmlxEventable(n),n._detachDomEvent=function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent&&n.detachEvent("on"+t,i)},n._init_once=function(){function i(n){for(var t=document.body;n&&n!=t;)n=n.parentNode;return!!(t==n)}function r(){return{w:window.innerWidth||document.documentElement.clientWidth,h:window.innerHeight||document.documentElement.clientHeight}}function u(n,t){return n.w==t.w&&n.h==t.h}var t=r();dhtmlxEvent(window,"resize",function(){i(n._obj)&&(window.clearTimeout(n._resize_timer),n._resize_timer=window.setTimeout(function(){var f=r();if(!u(t,f)){if(!i(n._obj))return;n.callEvent("onSchedulerResize",[])&&(n.updateView(),n.callEvent("onAfterSchedulerResize",[]))}t=f},100))});n._init_once=function(){}},n.init=function(t,i,r){i=i||n._currentDate();r=r||"week";this._obj&&this.unset_actions();this._obj=typeof t=="string"?document.getElementById(t):t;this.$container=this._obj;this.config.wai_aria_attributes&&this.config.wai_aria_application_role&&this.$container.setAttribute("role","application");this._skin_init&&n._skin_init();n.date.init();this._els=[];this._scroll=!0;this._quirks=_isIE&&document.compatMode=="BackCompat";this._quirks7=_isIE&&navigator.appVersion.indexOf("MSIE 8")==-1;this.get_elements();this.init_templates();this.set_actions();this._init_once();this._init_touch_events();this.set_sizes();n.callEvent("onSchedulerReady",[]);this.setCurrentView(i,r)},n.xy={min_event_height:40,scale_width:50,scroll_width:18,scale_height:20,month_scale_height:20,menu_width:25,margin_top:0,margin_left:0,editor_width:140,month_head_height:22,event_header_height:14},n.keys={edit_save:13,edit_cancel:27},n.bind=function(n,t){return n.bind?n.bind(t):function(){return n.apply(t,arguments)}},n.set_sizes=function(){var i=this._x=this._obj.clientWidth-this.xy.margin_left,f=this._y=this._obj.clientHeight-this.xy.margin_top,e=this._table_view?0:this.xy.scale_width+this.xy.scroll_width,o=this._table_view?-1:this.xy.scale_width,t=this.$container.querySelector(".dhx_cal_scale_placeholder"),r,u;n._is_material_skin()?(t||(t=document.createElement("div"),t.className="dhx_cal_scale_placeholder",this.$container.insertBefore(t,this._els.dhx_cal_header[0])),t.style.display="block",this.set_xy(t,i,this.xy.scale_height+1,0,this.xy.nav_height+(this._quirks?-1:1))):t&&t.parentNode.removeChild(t);this.set_xy(this._els.dhx_cal_navline[0],i,this.xy.nav_height,0,0);this.set_xy(this._els.dhx_cal_header[0],i-e,this.xy.scale_height,o,this.xy.nav_height+(this._quirks?-1:1));r=this._els.dhx_cal_navline[0].offsetHeight;r>0&&(this.xy.nav_height=r);u=this.xy.scale_height+this.xy.nav_height+(this._quirks?-2:0);this.set_xy(this._els.dhx_cal_data[0],i,f-(u+2),0,u+2)},n.set_xy=function(n,t,i,r,u){n.style.width=Math.max(0,t)+"px";n.style.height=Math.max(0,i)+"px";arguments.length>3&&(n.style.left=r+"px",n.style.top=u+"px")},n.get_elements=function(){for(var i,f,u,r=this._obj.getElementsByTagName("DIV"),t=0;t<r.length;t++)i=n._getClassName(r[t]),f=r[t].getAttribute("name")||"",i&&(i=i.split(" ")[0]),this._els[i]||(this._els[i]=[]),this._els[i].push(r[t]),u=n.locale.labels[f||i],typeof u!="string"&&f&&!r[t].innerHTML&&(u=f.split("_")[0]),u&&(this._waiAria.labelAttr(r[t],u),r[t].innerHTML=u)},n.unset_actions=function(){var n,t;for(n in this._els)if(this._click[n])for(t=0;t<this._els[n].length;t++)this._els[n][t].onclick=null;this._obj.onselectstart=null;this._obj.onmousemove=null;this._obj.onmousedown=null;this._obj.onmouseup=null;this._obj.ondblclick=null;this._obj.oncontextmenu=null},n.set_actions=function(){var t,i;for(t in this._els)if(this._click[t])for(i=0;i<this._els[t].length;i++)this._els[t][i].onclick=n._click[t];this._obj.onselectstart=function(){return!1};this._obj.onmousemove=function(t){n._temp_touch_block||n._on_mouse_move(t||event)};this._obj.onmousedown=function(t){n._ignore_next_click||n._on_mouse_down(t||event)};this._obj.onmouseup=function(t){n._ignore_next_click||n._on_mouse_up(t||event)};this._obj.ondblclick=function(t){n._on_dbl_click(t||event)};this._obj.oncontextmenu=function(t){var i=t||event,r=i.target||i.srcElement;return n.callEvent("onContextMenu",[n._locate_event(r),i])}},n.select=function(t){this._select_id!=t&&(n._close_not_saved(),this.editStop(!1),this.unselect(),this._select_id=t,this.updateEvent(t))},n.unselect=function(n){if(!n||n==this._select_id){var t=this._select_id;this._select_id=null;t&&this.getEvent(t)&&this.updateEvent(t)}},n.getState=function(){return{mode:this._mode,date:new Date(this._date),min_date:new Date(this._min_date),max_date:new Date(this._max_date),editor_id:this._edit_id,lightbox_id:this._lightbox_id,new_event:this._new_event,select_id:this._select_id,expanded:this.expanded,drag_id:this._drag_id,drag_mode:this._drag_mode}},n._click={dhx_cal_data:function(t){var r,i,u;if(n._ignore_next_click)return t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,n._ignore_next_click=!1,!1;if(r=t?t.target:event.srcElement,i=n._locate_event(r),t=t||event,i){if(!n.callEvent("onClick",[i,t])||n.config.readonly)return}else n.callEvent("onEmptyClick",[n.getActionData(t).date,t]);i&&n.config.select?(n.select(i),u=n._getClassName(r),u.indexOf("_icon")!=-1&&n._click.buttons[u.split(" ")[1].replace("icon_","")](i)):(n._close_not_saved(),(new Date).valueOf()-(n._new_event||0)>500&&n.unselect())},dhx_cal_prev_button:function(){n._click.dhx_cal_next_button(0,-1)},dhx_cal_next_button:function(t,i){n.setCurrentView(n.date.add(n.date[n._mode+"_start"](new Date(n._date)),i||1,n._mode))},dhx_cal_today_button:function(){n.callEvent("onBeforeTodayDisplayed",[])&&n.setCurrentView(n._currentDate())},dhx_cal_tab:function(){var t=this.getAttribute("name"),i=t.substring(0,t.search("_tab"));n.setCurrentView(n._date,i)},buttons:{"delete":function(t){var i=n.locale.labels.confirm_deleting;n._dhtmlx_confirm(i,n.locale.labels.title_confirm_deleting,function(){n.deleteEvent(t)})},edit:function(t){n.edit(t)},save:function(){n.editStop(!0)},details:function(t){n.showLightbox(t)},cancel:function(){n.editStop(!1)}}},n._dhtmlx_confirm=function(n,t,i){if(!n)return i();var r={text:n};t&&(r.title=t);i&&(r.callback=function(n){n&&i()});dhtmlx.confirm(r)},n.addEventNow=function(t,i,r){var u={},e,f,s,o,h;return n._isObject(t)&&!n._isDate(t)&&(u=t,t=null),e=(this.config.event_duration||this.config.time_step)*6e4,t||(t=u.start_date||Math.round(n._currentDate().valueOf()/e)*e),f=new Date(t),i||(s=this.config.first_hour,s>f.getHours()&&(f.setHours(s),t=f.valueOf()),i=t.valueOf()+e),o=new Date(i),f.valueOf()==o.valueOf()&&o.setTime(o.valueOf()+e),u.start_date=u.start_date||f,u.end_date=u.end_date||o,u.text=u.text||this.locale.labels.new_event,u.id=this._drag_id=u.id||this.uid(),this._drag_mode="new-size",this._loading=!0,h=this.addEvent(u),this.callEvent("onEventCreated",[this._drag_id,r]),this._loading=!1,this._drag_event={},this._on_mouse_up(r),h},n._on_dbl_click=function(t,i){var u,r,f;if(i=i||t.target||t.srcElement,!this.config.readonly){u=n._getClassName(i).split(" ")[0];switch(u){case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_wa_day_data":if(!n.config.dblclick_create)break;this.addEventNow(this.getActionData(t).date,null,t);break;case"dhx_cal_event":case"dhx_wa_ev_body":case"dhx_agenda_line":case"dhx_grid_event":case"dhx_cal_event_line":case"dhx_cal_event_clear":if(r=this._locate_event(i),!this.callEvent("onDblClick",[r,t]))return;this.config.details_on_dblclick||this._table_view||!this.getEvent(r)._timed||!this.config.select?this.showLightbox(r):this.edit(r);break;case"dhx_time_block":case"dhx_cal_container":return;default:if(f=this["dblclick_"+u],f)f.call(this,t);else if(i.parentNode&&i!=this)return n._on_dbl_click(t,i.parentNode)}}},n._get_column_index=function(n){var i=0,r,t;if(this._cols){for(r=0,t=0;r+this._cols[t]<n&&t<this._cols.length;)r+=this._cols[t],t++;if(i=t+(this._cols[t]?(n-r)/this._cols[t]:0),this._ignores&&i>=this._cols.length)while(i>=1&&this._ignores[Math.floor(i)])i--}return i},n._week_indexes_from_pos=function(n){if(this._cols){var t=this._get_column_index(n.x);return n.x=Math.min(this._cols.length-1,Math.max(0,Math.ceil(t)-1)),n.y=Math.max(0,Math.ceil(n.y*60/(this.config.time_step*this.config.hour_size_px))-1)+this.config.first_hour*(60/this.config.time_step),n}return n},n._mouse_coords=function(t){var i,u=document.body,o=document.documentElement,f,e,r;if(i=!_isIE&&(t.pageX||t.pageY)?{x:t.pageX,y:t.pageY}:{x:t.clientX+(u.scrollLeft||o.scrollLeft||0)-u.clientLeft,y:t.clientY+(u.scrollTop||o.scrollTop||0)-u.clientTop},i.x-=this.$domHelpers.getAbsoluteLeft(this._obj)+(this._table_view?0:this.xy.scale_width),i.y-=this.$domHelpers.getAbsoluteTop(this._obj)+this.xy.nav_height+(this._dy_shift||0)+this.xy.scale_height-this._els.dhx_cal_data[0].scrollTop,i.ev=t,f=this["mouse_"+this._mode],f)i=f.call(this,i);else if(this._table_view){if(e=this._get_column_index(i.x),!this._cols||!this._colsS)return i;for(r=0,r=1;r<this._colsS.heights.length;r++)if(this._colsS.heights[r]>i.y)break;i.y=Math.ceil((Math.max(0,e)+Math.max(0,r-1)*7)*1440/this.config.time_step);(n._drag_mode||this._mode=="month")&&(i.y=(Math.max(0,Math.ceil(e)-1)+Math.max(0,r-1)*7)*1440/this.config.time_step);this._drag_mode=="move"&&n._ignores_detected&&n.config.preserve_length&&(i._ignores=!0,this._drag_event._event_length||(this._drag_event._event_length=this._get_real_event_length(this._drag_event.start_date,this._drag_event.end_date,{x_step:1,x_unit:"day"})));i.x=0}else i=this._week_indexes_from_pos(i);return i.timestamp=+new Date,i},n._close_not_saved=function(){if((new Date).valueOf()-(n._new_event||0)>500&&n._edit_id){var t=n.locale.labels.confirm_closing;n._dhtmlx_confirm(t,n.locale.labels.title_confirm_closing,function(){n.editStop(n.config.positive_closing)});t&&(this._drag_id=this._drag_pos=this._drag_mode=null)}},n._correct_shift=function(t,i){return t-(new Date(n._min_date).getTimezoneOffset()-new Date(t).getTimezoneOffset())*6e4*(i?-1:1)},n._is_pos_changed=function(n,t){function i(n,t,i){return!!(Math.abs(n-t)>i)}if(!(n&&this._drag_pos))return!0;var r=5;return!!(this._drag_pos.has_moved||!this._drag_pos.timestamp||t.timestamp-this._drag_pos.timestamp>100||i(n.ev.clientX,t.ev.clientX,r)||i(n.ev.clientY,t.ev.clientY,r))},n._correct_drag_start_date=function(t){var i,r;return n.matrix&&(i=n.matrix[n._mode]),i=i||{x_step:1,x_unit:"day"},t=new Date(t),r=1,(i._start_correction||i._end_correction)&&(r=(i.last_hour||0)*60-(t.getHours()*60+t.getMinutes())||1),t*1+(n._get_fictional_event_length(t,r,i)-r)},n._correct_drag_end_date=function(t,i){var r,u;return n.matrix&&(r=n.matrix[n._mode]),r=r||{x_step:1,x_unit:"day"},u=t*1+n._get_fictional_event_length(t,i,r),new Date(u*1-(n._get_fictional_event_length(u,-1,r,-1)+1))},n._on_mouse_move=function(t){var r,f,i,h,b,y,c,o,e,s,p,k,w,u,a,v,l,d,g;if(this._drag_mode){if(r=this._mouse_coords(t),this._is_pos_changed(this._drag_pos,r)){if(this._edit_id!=this._drag_id&&this._close_not_saved(),!this._drag_mode)return;if(h=null,this._drag_pos&&!this._drag_pos.has_moved&&(h=this._drag_pos,h.has_moved=!0),this._drag_pos=r,this._drag_pos.has_moved=!0,this._drag_mode=="create"){if(h&&(r=h),this._close_not_saved(),this.unselect(this._select_id),this._loading=!0,f=this._get_date_from_pos(r).valueOf(),!this._drag_start){if(b=this.callEvent("onBeforeEventCreated",[t,this._drag_id]),!b){this._loading=!1;return}this._loading=!1;this._drag_start=f;return}i=f;i==this._drag_start;y=new Date(this._drag_start);c=new Date(i);(this._mode=="day"||this._mode=="week")&&y.getHours()==c.getHours()&&y.getMinutes()==c.getMinutes()&&(c=new Date(this._drag_start+1e3));this._drag_id=this.uid();this.addEvent(y,c,this.locale.labels.new_event,this._drag_id,r.fields);this.callEvent("onEventCreated",[this._drag_id,t]);this._loading=!1;this._drag_mode="new-size"}o=this.getEvent(this._drag_id);n.matrix&&(e=n.matrix[n._mode]);e=e||{x_step:1,x_unit:"day"};this._drag_mode=="move"?(f=this._min_date.valueOf()+(r.y*this.config.time_step+r.x*1440-(n._move_pos_shift||0))*6e4,!r.custom&&this._table_view&&(f+=this.date.time_part(o.start_date)*1e3),f=this._correct_shift(f),r._ignores&&this.config.preserve_length&&this._table_view?(f=n._correct_drag_start_date(f),i=n._correct_drag_end_date(f,this._drag_event._event_length)):i=o.end_date.valueOf()-(o.start_date.valueOf()-f)):(f=o.start_date.valueOf(),i=o.end_date.valueOf(),this._table_view?(s=this._min_date.valueOf()+r.y*this.config.time_step*6e4+(r.custom?0:864e5),this._mode=="month"?(s=this._correct_shift(s,!1),this._drag_from_start?(l=864e5,s<=n.date.date_part(new Date(i+l-1)).valueOf()&&(f=s-l)):i=s):this.config.preserve_length?r.resize_from_start?f=n._correct_drag_start_date(s):i=n._correct_drag_end_date(s,0):r.resize_from_start?f=s:i=s):(p=this.date.date_part(new Date(o.end_date.valueOf()-1)).valueOf(),k=new Date(p),i=p+r.y*this.config.time_step*6e4,i=i+(new Date(i).getTimezoneOffset()-k.getTimezoneOffset())*6e4,this._els.dhx_cal_data[0].style.cursor="s-resize",(this._mode=="week"||this._mode=="day")&&(i=this._correct_shift(i))),this._drag_mode=="new-size"?i<=this._drag_start?(w=r.shift||(this._table_view&&!r.custom?864e5:0),f=i-(r.shift?0:w),i=this._drag_start+(w||this.config.time_step*6e4)):f=this._drag_start:i<=f&&(i=f+this.config.time_step*6e4));a=new Date(i-1);u=new Date(f);this._drag_mode=="move"&&n.config.limit_drag_out&&(+u<+n._min_date||+i>+n._max_date)&&(+o.start_date<+n._min_date||+o.end_date>+n._max_date?(u=new Date(o.start_date),i=new Date(o.end_date)):(v=i-u,+u<+n._min_date?(u=new Date(n._min_date),r._ignores&&this.config.preserve_length&&this._table_view?(u=new Date(n._correct_drag_start_date(u)),e._start_correction&&(u=new Date(u.valueOf()+e._start_correction)),i=new Date(u*1+this._get_fictional_event_length(u,this._drag_event._event_length,e))):i=new Date(+u+v)):(i=new Date(n._max_date),r._ignores&&this.config.preserve_length&&this._table_view?(e._end_correction&&(i=new Date(i.valueOf()-e._end_correction)),i=new Date(i*1-this._get_fictional_event_length(i,0,e,!0)),u=new Date(i*1-this._get_fictional_event_length(i,this._drag_event._event_length,e,!0)),this._ignores_detected&&(u=n.date.add(u,e.x_step,e.x_unit),i=new Date(i*1-this._get_fictional_event_length(i,0,e,!0)),i=n.date.add(i,e.x_step,e.x_unit))):u=new Date(+i-v))),a=new Date(i-1));this._table_view||n.config.all_timed||!(!n._get_section_view()&&r.x!=this._get_event_sday({start_date:new Date(i),end_date:new Date(i)})||new Date(i).getHours()>=this.config.last_hour)||(v=i-u,l=this._min_date.valueOf()+r.x*864e5,i=n.date.date_part(new Date(l)),i.setHours(this.config.last_hour),a=new Date(i-1),this._drag_mode=="move"&&(u=new Date(+i-v)));(this._table_view||a.getDate()==u.getDate()&&a.getHours()<this.config.last_hour||n._allow_dnd)&&(o.start_date=u,o.end_date=new Date(i),this.config.update_render?(d=n._els.dhx_cal_data[0].scrollTop,this.update_view(),n._els.dhx_cal_data[0].scrollTop=d):this.updateEvent(this._drag_id));this._table_view&&this.for_rendered(this._drag_id,function(n){n.className+=" dhx_in_move dhx_cal_event_drag"});this.callEvent("onEventDrag",[this._drag_id,this._drag_mode,t])}}else n.checkEvent("onMouseMove")&&(g=this._locate_event(t.target||t.srcElement),this.callEvent("onMouseMove",[g,t]))},n._on_mouse_down=function(t,i){var r,f,u;if(t.button!=2&&!this.config.readonly&&!this._drag_mode){i=i||t.target||t.srcElement;r=n._getClassName(i).split(" ")[0];switch(r){case"dhx_cal_event_line":case"dhx_cal_event_clear":this._table_view&&(this._drag_mode="move");break;case"dhx_event_move":case"dhx_wa_ev_body":this._drag_mode="move";break;case"dhx_event_resize":this._drag_mode="resize";f=n._getClassName(i);n._drag_from_start=f.indexOf("dhx_event_resize_end")<0?!0:!1;break;case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_matrix_cell":case"dhx_marked_timespan":this._drag_mode="create";break;case"":if(i.parentNode)return n._on_mouse_down(t,i.parentNode);break;default:if((!n.checkEvent("onMouseDown")||n.callEvent("onMouseDown",[r,t]))&&i.parentNode&&i!=this&&r!="dhx_body")return n._on_mouse_down(t,i.parentNode);this._drag_mode=null;this._drag_id=null}if(this._drag_mode)if(u=this._locate_event(i),this.config["drag_"+this._drag_mode]&&this.callEvent("onBeforeDrag",[u,this._drag_mode,t])){if(this._drag_id=u,(this._edit_id!=this._drag_id||this._edit_id&&this._drag_mode=="create")&&this._close_not_saved(),!this._drag_mode)return;this._drag_event=n._lame_clone(this.getEvent(this._drag_id)||{});this._drag_pos=this._mouse_coords(t)}else this._drag_mode=this._drag_id=0;this._drag_start=null}},n._get_private_properties=function(n){var t={};for(var i in n)i.indexOf("_")===0&&(t[i]=!0);return t},n._clear_temporary_properties=function(n,t){var r=this._get_private_properties(n),u=this._get_private_properties(t);for(var i in u)r[i]||delete t[i]},n._on_mouse_up=function(t){var u;if(!t||t.button!=2||!this._mobile){if(this._drag_mode&&this._drag_id){this._els.dhx_cal_data[0].style.cursor="default";var i=this._drag_id,f=this._drag_mode,e=!this._drag_pos||this._drag_pos.has_moved,r=this.getEvent(this._drag_id);if(e&&(this._drag_event._dhx_changed||!this._drag_event.start_date||r.start_date.valueOf()!=this._drag_event.start_date.valueOf()||r.end_date.valueOf()!=this._drag_event.end_date.valueOf()))if(u=this._drag_mode=="new-size",this.callEvent("onBeforeEventChanged",[r,t,u,this._drag_event]))if(this._drag_id=this._drag_mode=null,u&&this.config.edit_on_create){if(this.unselect(),this._new_event=new Date,this._table_view||this.config.details_on_create||!this.config.select||!this.isOneDayEvent(this.getEvent(i)))return n.callEvent("onDragEnd",[i,f,t]),this.showLightbox(i);this._drag_pos=!0;this._select_id=this._edit_id=i}else this._new_event||this.callEvent(u?"onEventAdded":"onEventChanged",[i,this.getEvent(i)]);else u?this.deleteEvent(r.id,!0):(this._drag_event._dhx_changed=!1,this._clear_temporary_properties(r,this._drag_event),n._lame_copy(r,this._drag_event),this.updateEvent(r.id));this._drag_pos&&(this._drag_pos.has_moved||this._drag_pos===!0)&&(this._drag_id=this._drag_mode=null,this.render_view_data());n.callEvent("onDragEnd",[i,f,t])}this._drag_id=null;this._drag_mode=null;this._drag_pos=null}},n._trigger_dyn_loading=function(){return this._load_mode&&this._load()?(this._render_wait=!0,!0):!1},n.update_view=function(){this._reset_ignores();var n=this[this._mode+"_view"];if(n?n(!0):this._reset_scale(),this._trigger_dyn_loading())return!0;this.render_view_data()},n.isViewExists=function(t){return!!(n[t+"_view"]||n.date[t+"_start"]&&n.templates[t+"_date"]&&n.templates[t+"_scale_date"])},n._set_aria_buttons_attrs=function(){for(var r,u,f,t,i=["dhx_cal_next_button","dhx_cal_prev_button","dhx_cal_tab","dhx_cal_today_button"],n=0;n<i.length;n++)for(r=this._els[i[n]],u=0;r&&u<r.length;u++)f=r[u].getAttribute("name"),t=this.locale.labels[i[n]],f&&(t=this.locale.labels[f]||t),i[n]=="dhx_cal_next_button"?t=this.locale.labels.next:i[n]=="dhx_cal_prev_button"&&(t=this.locale.labels.prev),this._waiAria.headerButtonsAttributes(r[u],t||"")},n.updateView=function(n,t){var i,s,h,e,o,r,u;n=n||this._date;t=t||this._mode;var c="dhx_cal_data",f=this._obj,l="dhx_scheduler_"+this._mode,a="dhx_scheduler_"+t;if(this._mode&&f.className.indexOf(l)!=-1?f.className=f.className.replace(l,a):f.className+=" "+a,i="dhx_multi_day",s=this._mode==t&&this.config.preserve_scroll?this._els[c][0].scrollTop:!1,this._els[i]&&this._els[i][0]&&(h=this._els[i][0].scrollTop),this[this._mode+"_view"]&&t&&this._mode!=t&&this[this._mode+"_view"](!1),this._close_not_saved(),this._els[i]&&(this._els[i][0].parentNode.removeChild(this._els[i][0]),this._els[i]=null),this._mode=t,this._date=n,this._table_view=this._mode=="month",this._dy_shift=0,this._set_aria_buttons_attrs(),e=this._els.dhx_cal_tab,e)for(o=0;o<e.length;o++)r=e[o],u=r.className,u=u.replace(/ active/g,""),r.getAttribute("name")==this._mode+"_tab"?(u=u+" active",this._waiAria.headerToggleState(r,!0)):this._waiAria.headerToggleState(r,!1),r.className=u;this.update_view();typeof s=="number"&&(this._els[c][0].scrollTop=s);typeof h=="number"&&this._els[i]&&this._els[i][0]&&(this._els[i][0].scrollTop=h)},n.setCurrentView=function(n,t){this.callEvent("onBeforeViewChange",[this._mode,this._date,t||this._mode,n||this._date])&&(this.updateView(n,t),this.callEvent("onViewChange",[this._mode,this._date]))},n._render_x_header=function(n,t,i,r,u){var f,o,e;u=u||0;f=document.createElement("div");f.className="dhx_scale_bar";this.templates[this._mode+"_scalex_class"]&&(f.className+=" "+this.templates[this._mode+"_scalex_class"](i));o=this._cols[n]-1;this._mode=="month"&&n===0&&this.config.left_border&&(f.className+=" dhx_scale_bar_border",t=t+1);this.set_xy(f,o,this.xy.scale_height-2,t,u);e=this.templates[this._mode+"_scale_date"](i,this._mode);f.innerHTML=e;this._waiAria.dayHeaderAttr(f,e);r.appendChild(f)},n._get_columns_num=function(t,i){var u=7,r;return n._table_view||(r=n.date["get_"+n._mode+"_end"],r&&(i=r(t)),u=Math.round((i.valueOf()-t.valueOf())/864e5)),u},n._get_timeunit_start=function(){return this.date[this._mode+"_start"](new Date(this._date.valueOf()))},n._get_view_end=function(){var i=this._get_timeunit_start(),r=n.date.add(i,1,this._mode),t;return n._table_view||(t=n.date["get_"+n._mode+"_end"],t&&(r=t(i))),r},n._calc_scale_sizes=function(n,t,i){var e=n,u=this._get_columns_num(t,i),f,r;for(this._process_ignores(t,u,"day",1),f=u-this._ignores_detected,r=0;r<u;r++)this._ignores[r]?(this._cols[r]=0,f++):this._cols[r]=Math.floor(e/(f-r)),e-=this._cols[r],this._colsS[r]=(this._cols[r-1]||0)+(this._colsS[r-1]||(this._table_view?0:this.xy.scale_width+2));this._colsS.col_length=u;this._colsS[u]=this._cols[u-1]+this._colsS[u-1]||0},n._set_scale_col_size=function(n,t,i){var r=this.config;this.set_xy(n,t-1,r.hour_size_px*(r.last_hour-r.first_hour),i+this.xy.scale_width+1,0)},n._render_scales=function(t,i){var s=new Date(n._min_date),h=new Date(n._max_date),c=this.date.date_part(n._currentDate()),l=parseInt(t.style.width,10),r=new Date(this._min_date),a=this._get_columns_num(s,h),e,u,f,o;for(this._calc_scale_sizes(l,s,h),e=0,t.innerHTML="",u=0;u<a;u++)this._ignores[u]||this._render_x_header(u,e,r,t),this._table_view||(f=document.createElement("div"),o="dhx_scale_holder",r.valueOf()==c.valueOf()&&(o="dhx_scale_holder_now"),this._ignores_detected&&this._ignores[u]&&(o+=" dhx_scale_ignore"),f.className=o+" "+this.templates.week_date_class(r,c),this._waiAria.dayColumnAttr(f,r),this._set_scale_col_size(f,this._cols[u],e),i.appendChild(f),this.callEvent("onScaleAdd",[f,r])),e+=this._cols[u],r=this.date.add(r,1,"day"),r=this.date.day_start(r)},n._reset_scale=function(){var l,a,o,u,s,h,t,f;if(this.templates[this._mode+"_date"]){var c=this._els.dhx_cal_header[0],i=this._els.dhx_cal_data[0],e=this.config;if(c.innerHTML="",i.innerHTML="",l=(e.readonly||!e.drag_resize?" dhx_resize_denied":"")+(e.readonly||!e.drag_move?" dhx_move_denied":""),i.className="dhx_cal_data"+l,this._scales={},this._cols=[],this._colsS={height:0},this._dy_shift=0,this.set_sizes(),u=this._get_timeunit_start(),s=n._get_view_end(),a=o=this._table_view?n.date.week_start(u):u,this._min_date=a,h=this.templates[this._mode+"_date"](u,s,this._mode),this._els.dhx_cal_date[0].innerHTML=h,this._waiAria.navBarDateAttr(this._els.dhx_cal_date[0],h),this._max_date=s,n._render_scales(c,i),this._table_view)this._reset_month_scale(i,u,o);else if(this._reset_hours_scale(i,u,o),e.multi_day){t="dhx_multi_day";this._els[t]&&(this._els[t][0].parentNode.removeChild(this._els[t][0]),this._els[t]=null);var y=this._els.dhx_cal_navline[0],v=y.offsetHeight+this._els.dhx_cal_header[0].offsetHeight+1,r=document.createElement("div");r.className=t;r.style.visibility="hidden";this.set_xy(r,Math.max(this._colsS[this._colsS.col_length]+this.xy.scroll_width-2,0),0,0,v);i.parentNode.insertBefore(r,i);f=r.cloneNode(!0);f.className=t+"_icon";f.style.visibility="hidden";this.set_xy(f,this.xy.scale_width,0,0,v);r.appendChild(f);this._els[t]=[r,f];this._els[t][0].onclick=this._click.dhx_cal_data}}},n._reset_hours_scale=function(t){var u=document.createElement("div"),r,f,i,o,e;for(u.className="dhx_scale_holder",r=new Date(1980,1,1,this.config.first_hour,0,0),f=this.config.first_hour*1;f<this.config.last_hour;f++)i=document.createElement("div"),i.className="dhx_scale_hour",i.style.height=this.config.hour_size_px+"px",o=this.xy.scale_width,this.config.left_border&&(i.className+=" dhx_scale_hour_border"),i.style.width=o+"px",e=n.templates.hour_scale(r),i.innerHTML=e,this._waiAria.hourScaleAttr(i,e),u.appendChild(i),r=this.date.add(r,1,"hour");t.appendChild(u);this.config.scroll_hour&&(t.scrollTop=this.config.hour_size_px*(this.config.scroll_hour-this.config.first_hour))},n._currentDate=function(){return n.config.now_date?new Date(n.config.now_date):new Date},n._reset_ignores=function(){this._ignores={};this._ignores_detected=0},n._process_ignores=function(t,i,r,u,f){var s,e,o;if(this._reset_ignores(),s=n["ignore_"+this._mode],s)for(e=new Date(t),o=0;o<i;o++)s(e)&&(this._ignores_detected+=1,this._ignores[o]=!0,f&&i++),e=n.date.add(e,u,r),n.date[r+"_start"]&&(e=n.date[r+"_start"](e))},n._render_month_scale=function(t,i,r,u){function rt(t){var i=n._colsS.height;return n._colsS.heights[t+1]!==undefined&&(i=n._colsS.heights[t+1]-(n._colsS.heights[t]||0)),i}var it=n.date.add(i,1,"month"),et=new Date(r),p=n._currentDate(),w,v,b,c,k,s,d,ut,o,e,h,g,nt,y,l,tt,ft,t,f,a;for(this.date.date_part(p),this.date.date_part(r),u=u||Math.ceil(Math.round((it.valueOf()-r.valueOf())/864e5)/7),w=[],f=0;f<=7;f++)v=(this._cols[f]||0)-1,f===0&&this.config.left_border&&(v=v-1),w[f]=v+"px";for(b=0,c=document.createElement("table"),c.setAttribute("cellpadding","0"),c.setAttribute("cellspacing","0"),k=document.createElement("tbody"),c.appendChild(k),s=[],f=0;f<u;f++){for(d=document.createElement("tr"),k.appendChild(d),ut=Math.max(rt(f)-n.xy.month_head_height,0),o=0;o<7;o++)e=document.createElement("td"),d.appendChild(e),h="",r<i?h="dhx_before":r>=it?h="dhx_after":r.valueOf()==p.valueOf()&&(h="dhx_now"),this._ignores_detected&&this._ignores[o]&&(h+=" dhx_scale_ignore"),e.className=h+" "+this.templates.month_date_class(r,p),g="dhx_month_body",nt="dhx_month_head",o===0&&this.config.left_border&&(g+=" dhx_month_body_border",nt+=" dhx_month_head_border"),this._ignores_detected&&this._ignores[o]?(e.appendChild(document.createElement("div")),e.appendChild(document.createElement("div"))):(this._waiAria.monthCellAttr(e,r),y=document.createElement("div"),y.className=nt,y.innerHTML=this.templates.month_day(r),e.appendChild(y),l=document.createElement("div"),l.className=g,l.style.height=ut+"px",l.style.width=w[o],e.appendChild(l)),s.push(r),tt=r.getDate(),r=this.date.add(r,1,"day"),r.getDate()-tt>1&&(r=new Date(r.getFullYear(),r.getMonth(),tt+1,12,0));n._colsS.heights[f]=b;b+=rt(f)}for(this._min_date=et,this._max_date=r,t.innerHTML="",t.appendChild(c),this._scales={},ft=t.getElementsByTagName("div"),f=0;f<s.length;f++)t=ft[f*2+1],a=s[f],this._scales[+a]=t;for(f=0;f<s.length;f++)a=s[f],this.callEvent("onScaleAdd",[this._scales[+a],a]);return this._max_date},n._reset_month_scale=function(t,i,r,u){var e=n.date.add(i,1,"month"),o=n._currentDate(),f;return this.date.date_part(o),this.date.date_part(r),u=u||Math.ceil(Math.round((e.valueOf()-r.valueOf())/864e5)/7),f=Math.floor(t.clientHeight/u)-this.xy.month_head_height,this._colsS.height=f+this.xy.month_head_height,this._colsS.heights=[],n._render_month_scale(t,i,r,u)},n.getLabel=function(n,t){for(var u,i,f=this.config.lightbox.sections,r=0;r<f.length;r++)if(f[r].map_to==n)for(u=f[r].options,i=0;i<u.length;i++)if(u[i].key==t)return u[i].label;return""},n.updateCollection=function(t,i){var r=n.serverList(t);return r?(r.splice(0,r.length),r.push.apply(r,i||[]),n.callEvent("onOptionsLoad",[]),n.resetLightbox(),!0):!1},n._lame_clone=function(t,i){var r,u,f;for(i=i||[],r=0;r<i.length;r+=2)if(t===i[r])return i[r+1];if(t&&typeof t=="object"){for(f={},u=[Array,Date,Number,String,Boolean],r=0;r<u.length;r++)t instanceof u[r]&&(f=r?new u[r](t):new u[r]);i.push(t,f);for(r in t)Object.prototype.hasOwnProperty.apply(t,[r])&&(f[r]=n._lame_clone(t[r],i))}return f||t},n._lame_copy=function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n},n._get_date_from_pos=function(n){var t=this._min_date.valueOf()+(n.y*this.config.time_step+(this._table_view?0:n.x)*1440)*6e4;return new Date(this._correct_shift(t))},n.getActionData=function(n){var t=this._mouse_coords(n);return{date:this._get_date_from_pos(t),section:t.section}},n._focus=function(n,t){if(n&&n.focus)if(this._mobile)window.setTimeout(function(){n.focus()},10);else try{t&&n.select&&n.offsetWidth&&n.select();n.focus()}catch(i){}},n._get_real_event_length=function(t,i,r){var u=i-t,c=r._start_correction+r._end_correction||0,s=this["ignore_"+this._mode],h=0,f,e,o;for(r.render?(h=this._get_date_index(r,t),f=this._get_date_index(r,i)):f=Math.round(u/864e5),e=!0;h<f;)o=n.date.add(i,-r.x_step,r.x_unit),s&&s(i)&&(!e||e&&s(o))?u-=i-o:(e=!1,u-=c),i=o,f--;return u},n._get_fictional_event_length=function(t,i,r,u){var f=new Date(t),e=u?-1:1,a,h,o,l;(r._start_correction||r._end_correction)&&(a=u?f.getHours()*60+f.getMinutes()-(r.first_hour||0)*60:(r.last_hour||0)*60-(f.getHours()*60+f.getMinutes()),h=(r.last_hour-r.first_hour)*60,o=Math.ceil((i/6e4-a)/h),o<0&&(o=0),i+=o*(1440-h)*6e4);var y=new Date(t*1+i*e),v=this["ignore_"+this._mode],c=0,s;for(r.render?(c=this._get_date_index(r,f),s=this._get_date_index(r,y)):s=Math.round(i/864e5);c*e<=s*e;)l=n.date.add(f,r.x_step*e,r.x_unit),v&&v(f)&&(i+=(l-f)*e,s+=e),f=l,c+=e;return i},n._get_section_view=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode]:this._props&&this._props[this._mode]?this._props[this._mode]:null},n._get_section_property=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode].y_property:this._props&&this._props[this._mode]?this._props[this._mode].map_to:null},n._is_initialized=function(){var n=this.getState();return this._obj&&n.date&&n.mode},n._is_lightbox_open=function(){var n=this.getState();return n.lightbox_id!==null&&n.lightbox_id!==undefined},n._getClassName=function(n){if(!n)return"";var t=n.className||"";return t.baseVal&&(t=t.baseVal),t.indexOf||(t=""),t||""},n.event=window.dhtmlxEvent,n.eventRemove=function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent&&n.detachEvent("on"+t,i)},function(){function t(t){var r=!1,u=!1,f,i,e;return window.getComputedStyle?(f=window.getComputedStyle(t,null),r=f.display,u=f.visibility):t.currentStyle&&(r=t.currentStyle.display,u=t.currentStyle.visibility),i=!1,e=n._locate_css({target:t},"dhx_form_repeat",!1),e&&(i=!!(e.style.height=="0px")),i=i||!t.offsetHeight,r!="none"&&u!="hidden"&&!i}function i(n){return!isNaN(n.getAttribute("tabindex"))&&n.getAttribute("tabindex")*1>=0}function r(n){return{a:!0,area:!0}[n.nodeName.loLowerCase()]?!!n.getAttribute("href"):!0}function u(n){return{input:!0,select:!0,textarea:!0,button:!0,object:!0}[n.nodeName.toLowerCase()]?!n.hasAttribute("disabled"):!0}n._getFocusableNodes=function(n){for(var e,s,h=n.querySelectorAll("a[href], area[href], input, select, textarea, button, iframe, object, embed, [tabindex], [contenteditable]"),o=Array.prototype.slice.call(h,0),f=0;f<o.length;f++)e=o[f],s=(i(e)||u(e)||r(e))&&t(e),s||(o.splice(f,1),f--);return o}}(),n._trim=function(n){var t=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};return t.apply(n)},n._isDate=function(n){return n&&typeof n=="object"?!!(n.getFullYear&&n.getMonth&&n.getDate):!1},n._isObject=function(n){return n&&typeof n=="object"},function(){function t(n){return(n+"").replace(r," ").replace(u," ")}function e(n){return(n+"").replace(f,"&#39;")}function o(){return!n.config.wai_aria_attributes}var r=new RegExp("<(?:.|\n)*?>","gm"),u=new RegExp(" +","gm"),f=new RegExp("'","gm"),i;n._waiAria={getAttributeString:function(n){var r=[" "],i,u;for(i in n)typeof n[i]!="function"&&typeof n[i]!="object"&&(u=e(t(n[i])),r.push(i+"='"+u+"'"));return r.push(" "),r.join(" ")},setAttributes:function(n,i){for(var r in i)n.setAttribute(r,t(i[r]));return n},labelAttr:function(n,t){return this.setAttributes(n,{"aria-label":t})},label:function(t){return n._waiAria.getAttributeString({"aria-label":t})},hourScaleAttr:function(n,t){this.labelAttr(n,t)},monthCellAttr:function(t,i){this.labelAttr(t,n.templates.day_date(i))},navBarDateAttr:function(n,t){this.labelAttr(n,t)},dayHeaderAttr:function(n,t){this.labelAttr(n,t)},dayColumnAttr:function(t,i){this.dayHeaderAttr(t,n.templates.day_date(i))},headerButtonsAttributes:function(n,t){return this.setAttributes(n,{role:"button","aria-label":t})},headerToggleState:function(n,t){return this.setAttributes(n,{"aria-pressed":t?"true":"false"})},getHeaderCellAttr:function(t){return n._waiAria.getAttributeString({"aria-label":t})},eventAttr:function(n,t){this._eventCommonAttr(n,t)},_eventCommonAttr:function(i,r){r.setAttribute("aria-label",t(n.templates.event_text(i.start_date,i.end_date,i)));n.config.readonly&&r.setAttribute("aria-readonly",!0);i.$dataprocessor_class&&r.setAttribute("aria-busy",!0);r.setAttribute("aria-selected",n.getState().select_id==i.id?"true":"false")},setEventBarAttr:function(n,t){this._eventCommonAttr(n,t)},_getAttributes:function(n,t){var i={setAttribute:function(n,t){this[n]=t}};return n.apply(this,[t,i]),i},eventBarAttrString:function(n){return this.getAttributeString(this._getAttributes(this.setEventBarAttr,n))},agendaHeadAttrString:function(){return this.getAttributeString({role:"row"})},agendaHeadDateString:function(n){return this.getAttributeString({role:"columnheader","aria-label":n})},agendaHeadDescriptionString:function(n){return this.agendaHeadDateString(n)},agendaDataAttrString:function(){return this.getAttributeString({role:"grid"})},agendaEventAttrString:function(n){var t=this._getAttributes(this._eventCommonAttr,n);return t.role="row",this.getAttributeString(t)},agendaDetailsBtnString:function(){return this.getAttributeString({role:"button","aria-label":n.locale.labels.icon_details})},gridAttrString:function(){return this.getAttributeString({role:"grid"})},gridRowAttrString:function(n){return this.agendaEventAttrString(n)},gridCellAttrString:function(n,t,i){return this.getAttributeString({role:"gridcell","aria-label":[t.label===undefined?t.id:t.label,": ",i]})},mapAttrString:function(){return this.gridAttrString()},mapRowAttrString:function(n){return this.gridRowAttrString(n)},mapDetailsBtnString:function(){return this.agendaDetailsBtnString()},minicalHeader:function(n,t){this.setAttributes(n,{id:t+"","aria-live":"assertice","aria-atomic":"true"})},minicalGrid:function(n,t){this.setAttributes(n,{"aria-labelledby":t+"",role:"grid"})},minicalRow:function(n){this.setAttributes(n,{role:"row"})},minicalDayCell:function(t,i){var r=i.valueOf()<n._max_date.valueOf()&&i.valueOf()>=n._min_date.valueOf();this.setAttributes(t,{role:"gridcell","aria-label":n.templates.day_date(i),"aria-selected":r?"true":"false"})},minicalHeadCell:function(n){this.setAttributes(n,{role:"columnheader"})},weekAgendaDayCell:function(t){var r=t.querySelector(".dhx_wa_scale_bar"),u=t.querySelector(".dhx_wa_day_data"),i=n.uid()+"";this.setAttributes(r,{id:i});this.setAttributes(u,{"aria-labelledby":i})},weekAgendaEvent:function(n,t){this.eventAttr(t,n)},lightboxHiddenAttr:function(n){n.setAttribute("aria-hidden","true")},lightboxVisibleAttr:function(n){n.setAttribute("aria-hidden","false")},lightboxSectionButtonAttrString:function(n){return this.getAttributeString({role:"button","aria-label":n,tabindex:"0"})},yearHeader:function(n,t){this.setAttributes(n,{id:t+""})},yearGrid:function(n,t){this.minicalGrid(n,t)},yearHeadCell:function(n){return this.minicalHeadCell(n)},yearRow:function(n){return this.minicalRow(n)},yearDayCell:function(n){this.setAttributes(n,{role:"gridcell"})},lightboxAttr:function(n){n.setAttribute("role","dialog");n.setAttribute("aria-hidden","true");n.firstChild.setAttribute("role","heading")},lightboxButtonAttrString:function(t){return this.getAttributeString({role:"button","aria-label":n.locale.labels[t],tabindex:"0"})},eventMenuAttrString:function(t){return this.getAttributeString({role:"button","aria-label":n.locale.labels[t]})},lightboxHeader:function(n,t){n.setAttribute("aria-label",t)},lightboxSelectAttrString:function(t){var i="";switch(t){case"%Y":i=n.locale.labels.year;break;case"%m":i=n.locale.labels.month;break;case"%d":i=n.locale.labels.day;break;case"%H:%i":i=n.locale.labels.hour+" "+n.locale.labels.minute}return n._waiAria.getAttributeString({"aria-label":i})},messageButtonAttrString:function(n){return"tabindex='0' role='button' aria-label='"+n+"'"},messageInfoAttr:function(n){n.setAttribute("role","alert")},messageModalAttr:function(n,t){n.setAttribute("role","dialog");t&&n.setAttribute("aria-labelledby",t)},quickInfoAttr:function(n){n.setAttribute("role","dialog")},quickInfoHeaderAttrString:function(){return" role='heading' "},quickInfoHeader:function(n,t){n.setAttribute("aria-label",t)},quickInfoButtonAttrString:function(t){return n._waiAria.getAttributeString({role:"button","aria-label":t,tabindex:"0"})},tooltipAttr:function(n){n.setAttribute("role","tooltip")},tooltipVisibleAttr:function(n){n.setAttribute("aria-hidden","false")},tooltipHiddenAttr:function(n){n.setAttribute("aria-hidden","true")}};for(i in n._waiAria)n._waiAria[i]=function(n){return function(){return o()?" ":n.apply(this,arguments)}}(n._waiAria[i])}(),n.$domHelpers={getAbsoluteLeft:function(n){return this.getOffset(n).left},getAbsoluteTop:function(n){return this.getOffset(n).top},getOffsetSum:function(n){for(var t=0,i=0;n;)t=t+parseInt(n.offsetTop),i=i+parseInt(n.offsetLeft),n=n.offsetParent;return{top:t,left:i}},getOffsetRect:function(n){var i=n.getBoundingClientRect(),f=0,e=0,t,o;if(/Mobi/.test(navigator.userAgent))t=document.createElement("div"),t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.width="1px",t.style.height="1px",document.body.appendChild(t),o=t.getBoundingClientRect(),f=i.top-o.top,e=i.left-o.left,t.parentNode.removeChild(t);else{var r=document.body,u=document.documentElement,s=window.pageYOffset||u.scrollTop||r.scrollTop,h=window.pageXOffset||u.scrollLeft||r.scrollLeft,c=u.clientTop||r.clientTop||0,l=u.clientLeft||r.clientLeft||0;f=i.top+s-c;e=i.left+h-l}return{top:Math.round(f),left:Math.round(e)}},getOffset:function(n){return n.getBoundingClientRect?this.getOffsetRect(n):this.getOffsetSum(n)}},n.$env={isIE:navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0,isIE6:!window.XMLHttpRequest&&navigator.userAgent.indexOf("MSIE")>=0,isIE7:navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0,isIE8:navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,isOpera:navigator.userAgent.indexOf("Opera")>=0,isChrome:navigator.userAgent.indexOf("Chrome")>=0,isKHTML:navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0,isFF:navigator.userAgent.indexOf("Firefox")>=0,isIPad:navigator.userAgent.search(/iPad/gi)>=0,isEdge:navigator.userAgent.indexOf("Edge")!=-1},n.$ajax={_obj:n,cache:!0,method:"get",parse:function(t){if(typeof t!="string")return t;var i;return t=t.replace(/^[\s]+/,""),window.DOMParser&&!n.$env.isIE?i=(new window.DOMParser).parseFromString(t,"text/xml"):window.ActiveXObject!==window.undefined&&(i=new window.ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(t)),i},xmltop:function(n,t,i){if(typeof t.status=="undefined"||t.status<400){var r=t.responseXML?t.responseXML||t:this.parse(t.responseText||t);if(r&&r.documentElement!==null&&!r.getElementsByTagName("parsererror").length)return r.getElementsByTagName(n)[0]}return i!==-1&&this._obj.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],i]),document.createElement("DIV")},xpath:function(t,i){if(i.nodeName||(i=i.responseXML||i),n.$env.isIE)return i.selectNodes(t)||[];for(var u=[],r,f=(i.ownerDocument||i).evaluate(t,i,null,XPathResult.ANY_TYPE,null);;)if(r=f.iterateNext(),r)u.push(r);else break;return u},query:function(n){this._call(n.method||"GET",n.url,n.data||"",n.async||!0,n.callback,null,n.headers)},get:function(n,t){this._call("GET",n,null,!0,t)},getSync:function(n){return this._call("GET",n,null,!1)},put:function(n,t,i){this._call("PUT",n,t,!0,i)},del:function(n,t,i){this._call("DELETE",n,t,!0,i)},post:function(n,t,i){arguments.length==1?t="":arguments.length==2&&(typeof t=="function"||typeof window[t]=="function")?(i=t,t=""):t=String(t);this._call("POST",n,t,!0,i)},postSync:function(n,t){return t=t===null?"":String(t),this._call("POST",n,t,!1)},getLong:function(n,t){this._call("GET",n,null,!0,t,{url:n})},postLong:function(n,t,i){arguments.length==2&&(typeof t=="function"||typeof window[t])&&(i=t,t="");this._call("POST",n,t,!0,i,{url:n,postData:t})},_call:function(n,t,i,r,u,f,e){var h=this._obj,o=window.XMLHttpRequest&&!h.$env.isIE?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),c=navigator.userAgent.match(/AppleWebKit/)!==null&&navigator.userAgent.match(/Qt/)!==null&&navigator.userAgent.match(/Safari/)!==null,s;if(!r||(o.onreadystatechange=function(){if(o.readyState==4||c&&o.readyState==3){if((o.status!=200||o.responseText==="")&&!h.callEvent("onAjaxError",[o]))return;window.setTimeout(function(){typeof u=="function"&&u.apply(window,[{xmlDoc:o,filePath:t}]);f&&(typeof f.postData!="undefined"?this.postLong(f.url,f.postData,u):this.getLong(f.url,u));u=null;o=null},1)}}),n!="GET"||this.cache||(t+=(t.indexOf("?")>=0?"&":"?")+"dhxr"+(new Date).getTime()+"=1"),o.open(n,t,r),e)for(s in e)o.setRequestHeader(s,e[s]);else n.toUpperCase()=="POST"||n=="PUT"||n=="DELETE"?o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):n=="GET"&&(i=null);return o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.send(i),r?void 0:{xmlDoc:o,filePath:t}},urlSeparator:function(n){return n.indexOf("?")!=-1?"&":"?"}},n.date={init:function(){for(var i=n.locale.date.month_short,r=n.locale.date.month_short_hash={},t=0;t<i.length;t++)r[i[t]]=t;for(i=n.locale.date.month_full,r=n.locale.date.month_full_hash={},t=0;t<i.length;t++)r[i[t]]=t},_bind_host_object:function(t){return t.bind?t.bind(n):function(){return t.apply(n,arguments)}},date_part:function(n){var t=new Date(n);return n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),n.getHours()&&(n.getDate()<t.getDate()||n.getMonth()<t.getMonth()||n.getFullYear()<t.getFullYear())&&n.setTime(n.getTime()+36e5*(24-n.getHours())),n},time_part:function(n){return(n.valueOf()/1e3-n.getTimezoneOffset()*60)%86400},week_start:function(t){var i=t.getDay();return n.config.start_on_monday&&(i===0?i=6:i--),this.date_part(this.add(t,-1*i,"day"))},month_start:function(n){return n.setDate(1),this.date_part(n)},year_start:function(n){return n.setMonth(0),this.month_start(n)},day_start:function(n){return this.date_part(n)},_add_days:function(n,t){var i=new Date(n.valueOf()),u,r,f;return i.setDate(i.getDate()+t),t==Math.round(t)&&t>0&&(u=+i-+n,r=u%864e5,r&&n.getTimezoneOffset()==i.getTimezoneOffset()&&(f=r/36e5,i.setTime(i.getTime()+(24-f)*36e5))),t>=0&&!n.getHours()&&i.getHours()&&(i.getDate()<n.getDate()||i.getMonth()<n.getMonth()||i.getFullYear()<n.getFullYear())&&i.setTime(i.getTime()+36e5*(24-i.getHours())),i},add:function(t,i,r){var u=new Date(t.valueOf());switch(r){case"day":u=n.date._add_days(u,i);break;case"week":u=n.date._add_days(u,i*7);break;case"month":u.setMonth(u.getMonth()+i);break;case"year":u.setYear(u.getFullYear()+i);break;case"hour":u.setTime(u.getTime()+i*36e5);break;case"minute":u.setTime(u.getTime()+i*6e4);break;default:return n.date["add_"+r](t,i,r)}return u},to_fixed:function(n){return n<10?"0"+n:n},copy:function(n){return new Date(n.valueOf())},date_to_str:function(t,i){t=t.replace(/%[a-zA-Z]/g,function(n){switch(n){case"%d":return'"+this.date.to_fixed(date.getDate())+"';case"%m":return'"+this.date.to_fixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+this.date.to_fixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+this.locale.date.day_short[date.getDay()]+"';case"%l":return'"+this.locale.date.day_full[date.getDay()]+"';case"%M":return'"+this.locale.date.month_short[date.getMonth()]+"';case"%F":return'"+this.locale.date.month_full[date.getMonth()]+"';case"%h":return'"+this.date.to_fixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+this.date.to_fixed(date.getHours())+"';case"%i":return'"+this.date.to_fixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?"pm":"am")+"';case"%A":return'"+(date.getHours()>11?"PM":"AM")+"';case"%s":return'"+this.date.to_fixed(date.getSeconds())+"';case"%W":return'"+this.date.to_fixed(this.date.getISOWeek(date))+"';default:return n}});i&&(t=t.replace(/date\.get/g,"date.getUTC"));var r=new Function("date",'return "'+t+'";');return n.date._bind_host_object(r)},str_to_date:function(t,i){for(var f,o,u="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);",e=t.match(/%[a-zA-Z]/g),r=0;r<e.length;r++)switch(e[r]){case"%j":case"%d":u+="set[2]=temp["+r+"]||1;";break;case"%n":case"%m":u+="set[1]=(temp["+r+"]||1)-1;";break;case"%y":u+="set[0]=temp["+r+"]*1+(temp["+r+"]>50?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":u+="set[3]=temp["+r+"]||0;";break;case"%i":u+="set[4]=temp["+r+"]||0;";break;case"%Y":u+="set[0]=temp["+r+"]||0;";break;case"%a":case"%A":u+="set[3]=set[3]%12+((temp["+r+"]||'').toLowerCase()=='am'?0:12);";break;case"%s":u+="set[5]=temp["+r+"]||0;";break;case"%M":u+="set[1]=this.locale.date.month_short_hash[temp["+r+"]]||0;";break;case"%F":u+="set[1]=this.locale.date.month_full_hash[temp["+r+"]]||0;"}return f="set[0],set[1],set[2],set[3],set[4],set[5]",i&&(f=" Date.UTC("+f+")"),o=new Function("date","var set=[0,0,1,0,0,0]; "+u+" return new Date("+f+");"),n.date._bind_host_object(o)},getISOWeek:function(n){var t,i;if(!n)return!1;n=this.date_part(new Date(n));t=n.getDay();t===0&&(t=7);i=new Date(n.valueOf());i.setDate(n.getDate()+(4-t));var r=i.getFullYear(),u=Math.round((i.getTime()-new Date(r,0,1).getTime())/864e5);return 1+Math.floor(u/7)},getUTCISOWeek:function(n){return this.getISOWeek(this.convert_to_utc(n))},convert_to_utc:function(n){return new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds())}},n.locale={date:{month_full:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},labels:{dhx_cal_today_button:"Today",day_tab:"Day",week_tab:"Week",month_tab:"Month",new_event:"New event",icon_save:"Save",icon_cancel:"Cancel",icon_details:"Details",icon_edit:"Edit",icon_delete:"Delete",confirm_closing:"",confirm_deleting:"Event will be deleted permanently, are you sure?",section_description:"Description",section_time:"Time period",full_day:"Full day",confirm_recurring:"Do you want to edit the whole set of repeated events?",section_recurring:"Repeat event",button_recurring:"Disabled",button_recurring_open:"Enabled",button_edit_series:"Edit series",button_edit_occurrence:"Edit occurrence",agenda_tab:"Agenda",date:"Date",description:"Description",year_tab:"Year",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel",next:"Next",prev:"Previous",year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute"}},n.config={default_date:"%j %M %Y",month_date:"%F %Y",load_date:"%Y-%m-%d",week_date:"%l",day_date:"%D, %F %j",hour_date:"%H:%i",month_day:"%d",xml_date:"%m/%d/%Y %H:%i",api_date:"%d-%m-%Y %H:%i",preserve_length:!0,time_step:5,start_on_monday:1,first_hour:0,last_hour:24,readonly:!1,drag_resize:1,drag_move:1,drag_create:1,dblclick_create:1,edit_on_create:1,details_on_create:0,resize_month_events:!1,resize_month_timed:!1,cascade_event_display:!1,cascade_event_count:4,cascade_event_margin:30,multi_day:!0,multi_day_height_limit:0,drag_lightbox:!0,preserve_scroll:!0,select:!0,server_utc:!1,touch:!0,touch_tip:!0,touch_drag:500,quick_info_detached:!0,positive_closing:!1,drag_highlight:!0,limit_drag_out:!1,icons_edit:["icon_save","icon_cancel"],icons_select:["icon_details","icon_edit","icon_delete"],buttons_left:["dhx_save_btn","dhx_cancel_btn"],buttons_right:["dhx_delete_btn"],lightbox:{sections:[{name:"description",map_to:"text",type:"textarea",focus:!0},{name:"time",height:72,type:"time",map_to:"auto"}]},highlight_displayed_event:!0,left_border:!1,ajax_error:"alert",delay_render:0,timeline_swap_resize:!0,wai_aria_attributes:!0,wai_aria_application_role:!0},n.config.buttons_left.$inital=n.config.buttons_left.join(),n.config.buttons_right.$inital=n.config.buttons_right.join(),n.templates={},n.init_templates=function(){var r=n.locale.labels;r.dhx_save_btn=r.icon_save;r.dhx_cancel_btn=r.icon_cancel;r.dhx_delete_btn=r.icon_delete;var i=n.date.date_to_str,t=n.config,u=function(n,t){for(var i in t)n[i]||(n[i]=t[i])};u(n.templates,{day_date:i(t.default_date),month_date:i(t.month_date),week_date:function(t,i){return n.templates.day_date(t)+" &ndash; "+n.templates.day_date(n.date.add(i,-1,"day"))},day_scale_date:i(t.default_date),month_scale_date:i(t.week_date),week_scale_date:i(t.day_date),hour_scale:i(t.hour_date),time_picker:i(t.hour_date),event_date:i(t.hour_date),month_day:i(t.month_day),xml_date:n.date.str_to_date(t.xml_date,t.server_utc),load_format:i(t.load_date),xml_format:i(t.xml_date,t.server_utc),api_date:n.date.str_to_date(t.api_date),event_header:function(t,i){return n.templates.event_date(t)+" - "+n.templates.event_date(i)},event_text:function(n,t,i){return i.text},event_class:function(){return""},month_date_class:function(){return""},week_date_class:function(){return""},event_bar_date:function(t){return n.templates.event_date(t)+" "},event_bar_text:function(n,t,i){return i.text},month_events_link:function(n,t){return"<a>View more("+t+" events)<\/a>"},drag_marker_class:function(){return""},drag_marker_content:function(){return""},tooltip_date_format:n.date.date_to_str("%Y-%m-%d %H:%i"),tooltip_text:function(t,i,r){return"<b>Event:<\/b> "+r.text+"<br/><b>Start date:<\/b> "+n.templates.tooltip_date_format(t)+"<br/><b>End date:<\/b> "+n.templates.tooltip_date_format(i)}});this.callEvent("onTemplatesReady",[])},n.uid=function(){return this._seed||(this._seed=(new Date).valueOf()),this._seed++},n._events={},n.clearAll=function(){this._events={};this._loaded={};this._edit_id=null;this._select_id=null;this._drag_id=null;this._drag_mode=null;this._drag_pos=null;this.clear_view();this.callEvent("onClearAll",[])},n.addEvent=function(t,i,r,u,f){var e,o,s;return arguments.length?(e=t,arguments.length!=1&&(e=f||{},e.start_date=t,e.end_date=i,e.text=r,e.id=u),e.id=e.id||n.uid(),e.text=e.text||"",typeof e.start_date=="string"&&(e.start_date=this.templates.api_date(e.start_date)),typeof e.end_date=="string"&&(e.end_date=this.templates.api_date(e.end_date)),o=(this.config.event_duration||this.config.time_step)*6e4,e.start_date.valueOf()==e.end_date.valueOf()&&e.end_date.setTime(e.end_date.valueOf()+o),e._timed=this.isOneDayEvent(e),s=!this._events[e.id],this._events[e.id]=e,this.event_updated(e),this._loading||this.callEvent(s?"onEventAdded":"onEventChanged",[e.id,e]),e.id):this.addEventNow()},n.deleteEvent=function(n,t){var i=this._events[n];(t||this.callEvent("onBeforeEventDelete",[n,i])&&this.callEvent("onConfirmedBeforeEventDelete",[n,i]))&&(i&&(this._select_id=null,delete this._events[n],this.event_updated(i),this._drag_id==i.id&&(this._drag_id=null,this._drag_mode=null,this._drag_pos=null)),this.callEvent("onEventDeleted",[n,i]))},n.getEvent=function(n){return this._events[n]},n.setEvent=function(n,t){t.id||(t.id=n);this._events[n]=t},n.for_rendered=function(n,t){for(var i=this._rendered.length-1;i>=0;i--)this._rendered[i].getAttribute("event_id")==n&&t(this._rendered[i],i)},n.changeEventId=function(n,t){if(n!=t){var i=this._events[n];i&&(i.id=t,this._events[t]=i,delete this._events[n]);this.for_rendered(n,function(n){n.setAttribute("event_id",t)});this._select_id==n&&(this._select_id=t);this._edit_id==n&&(this._edit_id=t);this.callEvent("onEventIdChange",[n,t])}},function(){for(var i=["text","Text","start_date","StartDate","end_date","EndDate"],r=function(t){return function(i){return n.getEvent(i)[t]}},u=function(t){return function(i,r){var u=n.getEvent(i);u[t]=r;u._changed=!0;u._timed=this.isOneDayEvent(u);n.event_updated(u,!0)}},t=0;t<i.length;t+=2)n["getEvent"+i[t+1]]=r(i[t]),n["setEvent"+i[t+1]]=u(i[t])}(),n.event_updated=function(n){this.is_visible_events(n)?this.render_view_data():this.clear_event(n.id)},n.is_visible_events=function(n){var o=n.start_date.valueOf()<this._max_date.valueOf()&&this._min_date.valueOf()<n.end_date.valueOf(),f,e;if(o){var t=n.start_date.getHours(),i=n.end_date.getHours()+n.end_date.getMinutes()/60,r=this.config.last_hour,u=this.config.first_hour,s=this._table_view||!((i>r||i<u)&&(t>=r||t<u));return s?!0:(f=(n.end_date.valueOf()-n.start_date.valueOf())/36e5,e=24-(this.config.last_hour-this.config.first_hour),!!(f>e||t<r&&i>=u))}return!1},n.isOneDayEvent=function(n){var t=n.end_date.getDate()-n.start_date.getDate();return t?(t<0&&(t=Math.ceil((n.end_date.valueOf()-n.start_date.valueOf())/864e5)),t==1&&!n.end_date.getHours()&&!n.end_date.getMinutes()&&(n.start_date.getHours()||n.start_date.getMinutes())):n.start_date.getMonth()==n.end_date.getMonth()&&n.start_date.getFullYear()==n.end_date.getFullYear()},n.get_visible_events=function(n){var i=[];for(var t in this._events)this.is_visible_events(this._events[t])&&(!n||this._events[t]._timed)&&this.filter_event(t,this._events[t])&&i.push(this._events[t]);return i},n.filter_event=function(n,t){var i=this["filter_"+this._mode];return i?i(n,t):!0},n._is_main_area_event=function(n){return!!n._timed},n.render_view_data=function(n,t){var o=!1,s,r,u,i,f,e;if(!n){if(o=!0,this._not_render){this._render_wait=!0;return}this._render_wait=!1;this.clear_view();n=this.get_visible_events(!(this._table_view||this.config.multi_day))}for(i=0,s=n.length;i<s;i++)this._recalculate_timed(n[i]);if(this.config.multi_day&&!this._table_view){for(r=[],u=[],i=0;i<n.length;i++)this._is_main_area_event(n[i])?r.push(n[i]):u.push(n[i]);this._rendered_location=this._els.dhx_multi_day[0];this._table_view=!0;this.render_data(u,t);this._table_view=!1;this._rendered_location=this._els.dhx_cal_data[0];this._table_view=!1;this.render_data(r,t)}else f=document.createDocumentFragment(),e=this._els.dhx_cal_data[0],this._rendered_location=f,this.render_data(n,t),e.appendChild(f),this._rendered_location=e;o&&this.callEvent("onDataRender",[])},n._view_month_day=function(t){var i=n.getActionData(t).date;n.callEvent("onViewMoreClick",[i])&&n.setCurrentView(i,"day")},n._render_month_link=function(t){for(var e,i,s=this._rendered_location,u=this._lame_clone(t),f=t._sday;f<t._eday;f++){u._sday=f;u._eday=f+1;e=n.date;i=n._min_date;i=e.add(i,u._sweek,"week");i=e.add(i,u._sday,"day");var h=n.getEvents(i,e.add(i,1,"day")).length,o=this._get_event_bar_pos(u),c=o.x2-o.x,r=document.createElement("div");r.onclick=function(t){n._view_month_day(t||event)};r.className="dhx_month_link";r.style.top=o.y+"px";r.style.left=o.x+"px";r.style.width=c+"px";r.innerHTML=n.templates.month_events_link(i,h);this._rendered.push(r);s.appendChild(r)}},n._recalculate_timed=function(t){if(t){var i;(i=typeof t!="object"?this._events[t]:t,i)&&(i._timed=n.isOneDayEvent(i))}},n.attachEvent("onEventChanged",n._recalculate_timed),n.attachEvent("onEventAdded",n._recalculate_timed),n.render_data=function(t,i){var f,e,o,s,r,u;for(t=this._pre_render_events(t,i),f={},r=0;r<t.length;r++)if(this._table_view)n._mode!="month"?this.render_event_bar(t[r]):(e=n.config.max_month_events,e!==e*1||t[r]._sorder<e?this.render_event_bar(t[r]):e!==undefined&&t[r]._sorder==e&&n._render_month_link(t[r]));else{if(o=t[r],s=n.locate_holder(o._sday),!s)continue;f[o._sday]||(f[o._sday]={real:s,buffer:document.createDocumentFragment(),width:s.clientWidth});u=f[o._sday];this.render_event(o,u.buffer,u.width)}for(r in f)u=f[r],u.real&&u.buffer&&u.real.appendChild(u.buffer)},n._get_first_visible_cell=function(n){for(var t=0;t<n.length;t++)if((n[t].className||"").indexOf("dhx_scale_ignore")==-1)return n[t];return n[0]},n._pre_render_events=function(t,i){var o=this.xy.bar_height,d=this._colsS.heights,r=this._colsS.heights=[0,0,0,0,0,0,0],s=this._els.dhx_cal_data[0],f,u,h,c,l,a,w,e;if(t=this._table_view?this._pre_render_events_table(t,i):this._pre_render_events_line(t,i),this._table_view)if(i)this._colsS.heights=d;else if(f=s.firstChild,f.rows){for(u=0;u<f.rows.length;u++){if(r[u]++,h=f.rows[u].cells,c=this._colsS.height-this.xy.month_head_height,r[u]*o>c)for(l=c,this.config.max_month_events*1!==this.config.max_month_events||r[u]<=this.config.max_month_events?l=r[u]*o:(this.config.max_month_events+1)*o>c&&(l=(this.config.max_month_events+1)*o),a=0;a<h.length;a++)h[a].childNodes[1].style.height=l+"px";r[u]=(r[u-1]||0)+n._get_first_visible_cell(h).offsetHeight}if(r.unshift(0),f.parentNode.offsetHeight<f.parentNode.scrollHeight&&!n._colsS.scroll_fix&&n.xy.scroll_width){var v=n._colsS,b=v[v.col_length],g=v.heights.slice();b-=n.xy.scroll_width||0;this._calc_scale_sizes(b,this._min_date,this._max_date);n._colsS.heights=g;this.set_xy(this._els.dhx_cal_header[0],b,this.xy.scale_height);n._render_scales(this._els.dhx_cal_header[0]);n._render_month_scale(this._els.dhx_cal_data[0],this._get_timeunit_start(),this._min_date);v.scroll_fix=!0}}else if(t.length||this._els.dhx_multi_day[0].style.visibility!="visible"||(r[0]=-1),t.length||r[0]==-1){var nt=f.parentNode.childNodes,y=(r[0]+1)*o+1,p=y,k=y+"px";this.config.multi_day_height_limit&&(p=Math.min(y,this.config.multi_day_height_limit),k=p+"px");s.style.top=this._els.dhx_cal_navline[0].offsetHeight+this._els.dhx_cal_header[0].offsetHeight+p+"px";s.style.height=this._obj.offsetHeight-parseInt(s.style.top,10)-(this.xy.margin_top||0)+"px";w=this._els.dhx_multi_day[0];w.style.height=k;w.style.visibility=r[0]==-1?"hidden":"visible";e=this._els.dhx_multi_day[1];e.style.height=k;e.style.visibility=r[0]==-1?"hidden":"visible";e.className=r[0]?"dhx_multi_day_icon":"dhx_multi_day_icon_small";this._dy_shift=(r[0]+1)*o;this.config.multi_day_height_limit&&(this._dy_shift=Math.min(this.config.multi_day_height_limit,this._dy_shift));r[0]=0;p!=y&&(s.style.top=parseInt(s.style.top)+2+"px",w.style.overflowY="auto",e.style.position="fixed",e.style.top="",e.style.left="")}return t},n._get_event_sday=function(n){var t=this.date.day_start(new Date(n.start_date));return Math.round((t.valueOf()-this._min_date.valueOf())/864e5)},n._get_event_mapped_end_date=function(n){var t=n.end_date,i;return this.config.separate_short_events&&(i=(n.end_date-n.start_date)/6e4,i<this._min_mapped_duration&&(t=this.date.add(t,this._min_mapped_duration-i,"minute"))),t},n._pre_render_events_line=function(n,t){var e,o,r,c,y,f,s,h,p,l,a,u;for(n.sort(function(n,t){return n.start_date.valueOf()==t.start_date.valueOf()?n.id>t.id?1:-1:n.start_date>t.start_date?1:-1}),e=[],o=[],this._min_mapped_duration=Math.ceil(this.xy.min_event_height*60/this.config.hour_size_px),u=0;u<n.length;u++){var i=n[u],b=i.start_date,k=i.end_date,v=b.getHours(),w=k.getHours();if(i._sday=this._get_event_sday(i),this._ignores[i._sday]){n.splice(u,1);u--;continue}if(e[i._sday]||(e[i._sday]=[]),!t){for(i._inner=!1,r=e[i._sday];r.length;)if(s=r[r.length-1],h=this._get_event_mapped_end_date(s),h.valueOf()<=i.start_date.valueOf())r.splice(r.length-1,1);else break;for(c=r.length,y=!1,f=0;f<r.length;f++)if(s=r[f],h=this._get_event_mapped_end_date(s),h.valueOf()<=i.start_date.valueOf()){y=!0;i._sorder=s._sorder;c=f;i._inner=!0;break}if(r.length&&(r[r.length-1]._inner=!0),!y)if(r.length)if(r.length<=r[r.length-1]._sorder){if(r[r.length-1]._sorder)for(f=0;f<r.length;f++){for(p=!1,l=0;l<r.length;l++)if(r[l]._sorder==f){p=!0;break}if(!p){i._sorder=f;break}}else i._sorder=0;i._inner=!0}else{for(a=r[0]._sorder,f=1;f<r.length;f++)r[f]._sorder>a&&(a=r[f]._sorder);i._sorder=a+1;i._inner=!1}else i._sorder=0;r.splice(c,c==r.length?0:1,i);r.length>(r.max_count||0)?(r.max_count=r.length,i._count=r.length):i._count=i._count?i._count:1}if((v<this.config.first_hour||w>=this.config.last_hour)&&(o.push(i),n[u]=i=this._copy_event(i),v<this.config.first_hour&&(i.start_date.setHours(this.config.first_hour),i.start_date.setMinutes(0)),w>=this.config.last_hour&&(i.end_date.setMinutes(0),i.end_date.setHours(this.config.last_hour)),i.start_date>i.end_date||v==this.config.last_hour)){n.splice(u,1);u--;continue}}if(!t){for(u=0;u<n.length;u++)n[u]._count=e[n[u]._sday].max_count;for(u=0;u<o.length;u++)o[u]._count=e[o[u]._sday].max_count}return n},n._time_order=function(n){n.sort(function(n,t){return n.start_date.valueOf()==t.start_date.valueOf()?n._timed&&!t._timed?1:!n._timed&&t._timed?-1:n.id>t.id?1:-1:n.start_date>t.start_date?1:-1})},n._is_any_multiday_cell_visible=function(t,i,r){for(var h=this._cols.length,f=!1,u=t,e=!0,o,s;u<i;){if(e=!1,o=this.locate_holder_day(u,!1,r),s=o%h,!this._ignores[s]){f=!0;break}u=n.date.add(u,1,"day")}return e||f},n._pre_render_events_table=function(t,i){var c,r,l,w,b,d,o,s,u;this._time_order(t);var v=[],g=[[],[],[],[],[],[],[]],k=this._colsS.heights,y,f=this._cols.length,p={};for(c=0;c<t.length;c++){r=t[c];l=r.id;p[l]||(p[l]={first_chunk:!0,last_chunk:!0});var e=p[l],h=y||r.start_date,a=r.end_date;if((h<this._min_date&&(e.first_chunk=!1,h=this._min_date),a>this._max_date&&(e.last_chunk=!1,a=this._max_date),w=this.locate_holder_day(h,!1,r),r._sday=w%f,!this._ignores[r._sday]||!r._timed)&&(b=this.locate_holder_day(a,!0,r)||f,r._eday=b%f||f,r._length=b-w,r._sweek=Math.floor((this._correct_shift(h.valueOf(),1)-this._min_date.valueOf())/(864e5*f)),d=n._is_any_multiday_cell_visible(h,a,r),d)){for(o=g[r._sweek],s=0;s<o.length;s++)if(o[s]._eday<=r._sday)break;if(r._sorder&&i||(r._sorder=s),r._sday+r._length<=f)y=null,v.push(r),o[s]=r,k[r._sweek]=o.length-1,r._first_chunk=e.first_chunk,r._last_chunk=e.last_chunk;else{u=this._copy_event(r);u.id=r.id;u._length=f-r._sday;u._eday=f;u._sday=r._sday;u._sweek=r._sweek;u._sorder=r._sorder;u.end_date=this.date.add(h,u._length,"day");u._first_chunk=e.first_chunk;e.first_chunk&&(e.first_chunk=!1);v.push(u);o[s]=u;y=u.end_date;k[r._sweek]=o.length-1;c--;continue}}}return v},n._copy_dummy=function(){var n=new Date(this.start_date),t=new Date(this.end_date);this.start_date=n;this.end_date=t},n._copy_event=function(n){return this._copy_dummy.prototype=n,new this._copy_dummy},n._rendered=[],n.clear_view=function(){for(var t,n=0;n<this._rendered.length;n++)t=this._rendered[n],t.parentNode&&t.parentNode.removeChild(t);this._rendered=[]},n.updateEvent=function(n){var t=this.getEvent(n);this.clear_event(n);t&&this.is_visible_events(t)&&this.filter_event(n,t)&&(this._table_view||this.config.multi_day||t._timed)&&(this.config.update_render?this.render_view_data():this.getState().mode!="month"||this.getState().drag_id||this.isOneDayEvent(t)?this.render_view_data([t],!0):this.render_view_data())},n.clear_event=function(t){this.for_rendered(t,function(t,i){t.parentNode&&t.parentNode.removeChild(t);n._rendered.splice(i,1)})},n._y_from_date=function(n){var t=n.getHours()*60+n.getMinutes();return Math.round((t*6e4-this.config.first_hour*36e5)*this.config.hour_size_px/36e5)%(this.config.hour_size_px*24)},n._calc_event_y=function(t,i){i=i||0;var r=t.start_date.getHours()*60+t.start_date.getMinutes(),u=t.end_date.getHours()*60+t.end_date.getMinutes()||n.config.last_hour*60,f=this._y_from_date(t.start_date),e=Math.max(i,(u-r)*this.config.hour_size_px/60);return{top:f,height:e}},n.render_event=function(t,i,r){var l=n.xy.menu_width,a=this.config.use_select_menu_space?0:l,h,f,e,k,d,tt,u,g,o,s,p;if(!(t._sday<0)&&(h=n.locate_holder(t._sday),h)){i=i||h;var nt=this._calc_event_y(t,n.xy.min_event_height),w=nt.top,v=nt.height,b=t._count||1,y=t._sorder||0;if(r=r||h.clientWidth,f=Math.floor((r-a)/b),e=y*f+1,t._inner||(f=f*(b-y)),this.config.cascade_event_display&&(k=this.config.cascade_event_count,d=this.config.cascade_event_margin,e=y%k*d,tt=t._inner?(b-y-1)%k*d/2:0,f=Math.floor(r-a-e-tt)),u=this._render_v_bar(t,a+e,w,f,v,t._text_style,n.templates.event_header(t.start_date,t.end_date,t),n.templates.event_text(t.start_date,t.end_date,t)),this._waiAria.eventAttr(t,u),this._rendered.push(u),i.appendChild(u),e=e+parseInt(h.style.left,10)+a,this._edit_id==t.id&&(u.style.zIndex=1,f=Math.max(f-4,n.xy.editor_width),u=document.createElement("div"),u.setAttribute("event_id",t.id),this._waiAria.eventAttr(t,u),this.set_xy(u,f,v-20,e,w+(n.xy.event_header_height||14)),u.className="dhx_cal_event dhx_cal_editor",t.color&&(u.style.backgroundColor=t.color),g=n.templates.event_class(t.start_date,t.end_date,t),g&&(u.className+=" "+g),o=document.createElement("div"),this.set_xy(o,f-6,v-26),o.style.cssText+=";margin:2px 2px 2px 2px;overflow:hidden;",u.appendChild(o),this._els.dhx_cal_data[0].appendChild(u),this._rendered.push(u),o.innerHTML="<textarea class='dhx_cal_editor'>"+t.text+"<\/textarea>",this._quirks7&&(o.firstChild.style.height=v-12+"px"),this._editor=o.firstChild,this._editor.onkeydown=function(t){if((t||event).shiftKey)return!0;var i=(t||event).keyCode;i==n.keys.edit_save&&n.editStop(!0);i==n.keys.edit_cancel&&n.editStop(!1);(i==n.keys.edit_save||i==n.keys.edit_cancel)&&t.preventDefault&&t.preventDefault()},this._editor.onselectstart=function(n){return(n||event).cancelBubble=!0,!0},n._focus(o.firstChild,!0),this._els.dhx_cal_data[0].scrollLeft=0),this.xy.menu_width!==0&&this._select_id==t.id){this.config.cascade_event_display&&this._drag_mode&&(u.style.zIndex=1);var c=this.config["icons_"+(this._edit_id==t.id?"edit":"select")],it="",rt=t.color?"background-color: "+t.color+";":"",ut=t.textColor?"color: "+t.textColor+";":"",ft;for(s=0;s<c.length;s++)ft=this._waiAria.eventMenuAttrString(c[s]),it+="<div class='dhx_menu_icon "+c[s]+"' style='"+rt+""+ut+"' title='"+this.locale.labels[c[s]]+"'"+ft+"><\/div>";p=this._render_v_bar(t,e-l+1,w,l,c.length*20+26-2,"","<div style='"+rt+""+ut+"' class='dhx_menu_head'><\/div>",it,!0);p.style.left=e-l+1;this._els.dhx_cal_data[0].appendChild(p);this._rendered.push(p)}this.config.drag_highlight&&this._drag_id==t.id&&this.highlightEventPosition(t)}},n._render_v_bar=function(t,i,r,u,f,e,o,s,h){var b=document.createElement("div"),nt=t.id,c=h?"dhx_cal_event dhx_cal_select_menu":"dhx_cal_event",g=n.getState(),k,l,v,w;g.drag_id==t.id&&(c+=" dhx_cal_event_drag");g.select_id==t.id&&(c+=" dhx_cal_event_selected");k=n.templates.event_class(t.start_date,t.end_date,t);k&&(c=c+" "+k);this.config.cascade_event_display&&(c+=" dhx_cal_event_cascade");var y=t.color?"background-color:"+t.color+";":"",d=t.textColor?"color:"+t.textColor+";":"",a=n._border_box_bvents(),p=u-2,tt=a?p:u-4,it=a?p:u-6,rt=a?p:u-(this._quirks?4:14),ut=a?p-2:u-8,ft=a?f-this.xy.event_header_height-1:f-(this._quirks?20:30)+1,et='<div event_id="'+nt+'" class="'+c+'" style="position:absolute; top:'+r+"px; left:"+i+"px; width:"+tt+"px; height:"+f+"px;"+(e||"")+'"><\/div>';return(b.innerHTML=et,l=b.cloneNode(!0).firstChild,!h&&n.renderEvent(l,t,u,f,o,s))?l:(l=b.firstChild,v='<div class="dhx_event_move dhx_header" style=" width:'+it+"px;"+y+'" >&nbsp;<\/div>',v+='<div class="dhx_event_move dhx_title" style="'+y+""+d+'">'+o+"<\/div>",v+='<div class="dhx_body" style=" width:'+rt+"px; height:"+ft+"px;"+y+""+d+'">'+s+"<\/div>",w="dhx_event_resize dhx_footer",(h||t._drag_resize===!1)&&(w="dhx_resize_denied "+w),v+='<div class="'+w+'" style=" width:'+ut+"px;"+(h?" margin-top:-1px;":"")+""+y+""+d+'" ><\/div>',l.innerHTML=v,l)},n.renderEvent=function(){return!1},n.locate_holder=function(n){return this._mode=="day"?this._els.dhx_cal_data[0].firstChild:this._els.dhx_cal_data[0].childNodes[n]},n.locate_holder_day=function(n,t){var i=Math.floor((this._correct_shift(n,1)-this._min_date)/864e5);return t&&this.date.time_part(n)&&i++,i},n._get_dnd_order=function(n,t,i){if(!this._drag_event)return n;this._drag_event._orig_sorder?n=this._drag_event._orig_sorder:this._drag_event._orig_sorder=n;for(var r=t*n;r+t>i;)n--,r-=t;return Math.max(n,0)},n._get_event_bar_pos=function(t){var f=this._colsS[t._sday],r=this._colsS[t._eday],u,i,e,o,s;return r==f&&(r=this._colsS[t._eday+1]),u=this.xy.bar_height,i=t._sorder,t.id==this._drag_id&&(e=this._colsS.heights[t._sweek+1]-this._colsS.heights[t._sweek]-this.xy.month_head_height,i=n._get_dnd_order(i,u,e)),o=i*u,s=this._colsS.heights[t._sweek]+(this._colsS.height?this.xy.month_scale_height+2:2)+o,{x:f,x2:r,y:s}},n.render_event_bar=function(t){var v=this._rendered_location,f=this._get_event_bar_pos(t),y=f.y,h=f.x,c=f.x2,e="",s;if(c){var u=n.config.resize_month_events&&this._mode=="month"&&(!t._timed||n.config.resize_month_timed),o=document.createElement("div"),l=t.hasOwnProperty("_first_chunk")&&t._first_chunk,a=t.hasOwnProperty("_last_chunk")&&t._last_chunk,p=u&&(t._timed||l),w=u&&(t._timed||a),i="dhx_cal_event_clear";(!t._timed||u)&&(i="dhx_cal_event_line");l&&(i+=" dhx_cal_event_line_start");a&&(i+=" dhx_cal_event_line_end");p&&(e+="<div class='dhx_event_resize dhx_event_resize_start'><\/div>");w&&(e+="<div class='dhx_event_resize dhx_event_resize_end'><\/div>");s=n.templates.event_class(t.start_date,t.end_date,t);s&&(i+=" "+s);var b=t.color?"background:"+t.color+";":"",k=t.textColor?"color:"+t.textColor+";":"",d=["position:absolute","top:"+y+"px","left:"+h+"px","width:"+(c-h-15)+"px",k,b,t._text_style||""].join(";"),r="<div event_id='"+t.id+"' class='"+i+"' style='"+d+"'"+this._waiAria.eventBarAttrString(t)+">";u&&(r+=e);n.getState().mode=="month"&&(t=n.getEvent(t.id));t._timed&&(r+=n.templates.event_bar_date(t.start_date,t.end_date,t));r+=n.templates.event_bar_text(t.start_date,t.end_date,t)+"<\/div>";r+="<\/div>";o.innerHTML=r;this._rendered.push(o.firstChild);v.appendChild(o.firstChild)}},n._locate_event=function(n){for(var t=null;n&&!t&&n.getAttribute;)t=n.getAttribute("event_id"),n=n.parentNode;return t},n._locate_css=function(t,i,r){var f,u,e,o,s;for(r===undefined&&(r=!0),f=t.target||t.srcElement,u="";f;){if(u=n._getClassName(f),u&&(e=u.indexOf(i),e>=0&&(!r||(o=e===0||!n._trim(u.charAt(e-1)),s=e+i.length>=u.length||!n._trim(u.charAt(e+i.length)),o&&s))))return f;f=f.parentNode}return null},n.edit=function(n){this._edit_id!=n&&(this.editStop(!1,n),this._edit_id=n,this.updateEvent(n))},n.editStop=function(n,t){if(!t||this._edit_id!=t){var i=this.getEvent(this._edit_id);i&&(n&&(i.text=this._editor.value),this._edit_id=null,this._editor=null,this.updateEvent(i.id),this._edit_stop_event(i,n))}},n._edit_stop_event=function(n,t){this._new_event?(t?this.callEvent("onEventAdded",[n.id,n]):n&&this.deleteEvent(n.id,!0),this._new_event=null):t&&this.callEvent("onEventChanged",[n.id,n])},n.getEvents=function(n,t){var r=[],u,i;for(u in this._events)i=this._events[u],i&&(!n&&!t||i.start_date<t&&i.end_date>n)&&r.push(i);return r},n.getRenderedEvent=function(t){var r,i,u;if(t){for(r=n._rendered,i=0;i<r.length;i++)if(u=r[i],u.getAttribute("event_id")==t)return u;return null}},n.showEvent=function(t,i){var r=typeof t=="number"||typeof t=="string"?n.getEvent(t):t,f,e,o,s,u;(i=i||n._mode,r&&(!this.checkEvent("onBeforeEventDisplay")||this.callEvent("onBeforeEventDisplay",[r,i])))&&(f=n.config.scroll_hour,n.config.scroll_hour=r.start_date.getHours(),e=n.config.preserve_scroll,n.config.preserve_scroll=!1,o=r.color,s=r.textColor,n.config.highlight_displayed_event&&(r.color=n.config.displayed_event_color,r.textColor=n.config.displayed_event_text_color),n.setCurrentView(new Date(r.start_date),i),r.color=o,r.textColor=s,n.config.scroll_hour=f,n.config.preserve_scroll=e,n.matrix&&n.matrix[i]&&(u=n.getRenderedEvent(r.id),u&&(n._els.dhx_cal_data[0].scrollTop=n.$domHelpers.getAbsoluteTop(u)-n.$domHelpers.getAbsoluteTop(n._els.dhx_cal_data[0])-20)),n.callEvent("onAfterEventDisplay",[r,i]))},n._append_drag_marker=function(t){if(!t.parentNode){var u=n._els.dhx_cal_data[0],i=u.lastChild,r=n._getClassName(i);r.indexOf("dhx_scale_holder")<0&&i.previousSibling&&(i=i.previousSibling);r=n._getClassName(i);i&&r.indexOf("dhx_scale_holder")===0&&i.appendChild(t)}},n._update_marker_position=function(t,i){var r=n._calc_event_y(i,0);t.style.top=r.top+"px";t.style.height=r.height+"px"},n.highlightEventPosition=function(n){var t=document.createElement("div"),i,r;t.setAttribute("event_id",n.id);this._rendered.push(t);this._update_marker_position(t,n);i=this.templates.drag_marker_class(n.start_date,n.end_date,n);r=this.templates.drag_marker_content(n.start_date,n.end_date,n);t.className="dhx_drag_marker";i&&(t.className+=" "+i);r&&(t.innerHTML=r);this._append_drag_marker(t)},n._loaded={},n._load=function(t,i){var r,u,e,f;if(t=t||this._load_url,t){if(t+=(t.indexOf("?")==-1?"?":"&")+"timeshift="+(new Date).getTimezoneOffset(),this.config.prevent_cache&&(t+="&uid="+this.uid()),i=i||this._date,this._load_mode){for(u=this.templates.load_format,i=this.date[this._load_mode+"_start"](new Date(i.valueOf()));i>this._min_date;)i=this.date.add(i,-1,this._load_mode);for(r=i,e=!0;r<this._max_date;)r=this.date.add(r,1,this._load_mode),this._loaded[u(i)]&&e?i=this.date.add(i,1,this._load_mode):e=!1;f=r;do r=f,f=this.date.add(r,-1,this._load_mode);while(f>i&&this._loaded[u(f)]);if(r<=i)return!1;for(n.$ajax.get(t+"&from="+u(i)+"&to="+u(r),function(t){n.on_load(t)});i<r;)this._loaded[u(i)]=!0,i=this.date.add(i,1,this._load_mode)}else n.$ajax.get(t,function(t){n.on_load(t)});return this.callEvent("onXLS",[]),!0}},n.on_load=function(t){var i,r=!1;if(this._process&&this._process!="xml")try{i=this[this._process].parse(t.xmlDoc.responseText)}catch(u){r=!0}else i=this._magic_parser(t),i||(r=!0);(r||t.xmlDoc.status&&t.xmlDoc.status>=400)&&(this.callEvent("onLoadError",[t.xmlDoc]),i=[]);n._process_loading(i);this.callEvent("onXLE",[])},n._process_loading=function(n){this._loading=!0;this._not_render=!0;for(var t=0;t<n.length;t++)this.callEvent("onEventLoading",[n[t]])&&this.addEvent(n[t]);this._not_render=!1;this._render_wait&&this.render_view_data();this._loading=!1;this._after_call&&this._after_call();this._after_call=null},n._init_event=function(t){t.text=t.text||t._tagvalue||"";t.start_date=n._init_date(t.start_date);t.end_date=n._init_date(t.end_date)},n._init_date=function(t){return t?typeof t=="string"?n.templates.xml_date(t):new Date(t):null},n.json={},n.json.parse=function(t){var e,h,f,c,i,o,r,l,u,a,s,v;typeof t=="string"&&(n._temp=window.JSON?JSON.parse(t):eval("("+t+")"),t=n._temp?n._temp.data||n._temp.d||n._temp:[]);t.dhx_security&&(dhtmlx.security_key=t.dhx_security);e=n._temp&&n._temp.collections?n._temp.collections:{};h=!1;for(f in e)if(e.hasOwnProperty(f))for(h=!0,c=e[f],i=n.serverList[f],i||(n.serverList[f]=i=[]),i.splice(0,i.length),o=0;o<c.length;o++){r=c[o];l={key:r.value,label:r.label};for(u in r)if(r.hasOwnProperty(u)){if(u=="value"||u=="label")continue;l[u]=r[u]}i.push(l)}for(h&&n.callEvent("onOptionsLoad",[]),a=[],s=0;s<t.length;s++)v=t[s],n._init_event(v),a.push(v);return a},n.parse=function(n,t){this._process=t;this.on_load({xmlDoc:{responseText:n}})},n.load=function(n,t){typeof t=="string"&&(this._process=t,t=arguments[2]);this._load_url=n;this._after_call=t;this._load(n,this._date)},n.setLoadMode=function(n){n=="all"&&(n="");this._load_mode=n},n.serverList=function(n,t){return t?(this.serverList[n]=t.slice(0),this.serverList[n]):(this.serverList[n]=this.serverList[n]||[],this.serverList[n])},n._userdata={},n._magic_parser=function(t){var r,c,e,l,u,o,f,h,s,a,v,y,i,b;if(t.xmlDoc.responseXML||(t.xmlDoc.responseXML=n.$ajax.parse(t.xmlDoc.responseText)),r=n.$ajax.xmltop("data",t.xmlDoc),r.tagName!="data")return null;for(c=r.getAttribute("dhx_security"),c&&(dhtmlx.security_key=c),e=n.$ajax.xpath("//coll_options",t.xmlDoc),i=0;i<e.length;i++)for(l=e[i].getAttribute("for"),u=this.serverList[l],u||(n.serverList[l]=u=[]),u.splice(0,u.length),o=n.$ajax.xpath(".//item",e[i]),f=0;f<o.length;f++){var k=o[f],p=k.attributes,w={key:o[f].getAttribute("value"),label:o[f].getAttribute("label")};for(h=0;h<p.length;h++)(s=p[h],s.nodeName!="value"&&s.nodeName!="label")&&(w[s.nodeName]=s.nodeValue);u.push(w)}for(e.length&&n.callEvent("onOptionsLoad",[]),a=n.$ajax.xpath("//userdata",t.xmlDoc),i=0;i<a.length;i++)v=this._xmlNodeToJSON(a[i]),this._userdata[v.name]=v.text;for(y=[],r=n.$ajax.xpath("//event",t.xmlDoc),i=0;i<r.length;i++)b=y[i]=this._xmlNodeToJSON(r[i]),n._init_event(b);return y},n._xmlNodeToJSON=function(n){for(var r,i={},t=0;t<n.attributes.length;t++)i[n.attributes[t].name]=n.attributes[t].value;for(t=0;t<n.childNodes.length;t++)r=n.childNodes[t],r.nodeType==1&&(i[r.tagName]=r.firstChild?r.firstChild.nodeValue:"");return i.text||(i.text=n.firstChild?n.firstChild.nodeValue:""),i},n.attachEvent("onXLS",function(){if(this.config.show_loading===!0){var n;n=this.config.show_loading=document.createElement("div");n.className="dhx_loading";n.style.left=Math.round((this._x-128)/2)+"px";n.style.top=Math.round((this._y-15)/2)+"px";this._obj.appendChild(n)}}),n.attachEvent("onXLE",function(){var n=this.config.show_loading;n&&typeof n=="object"&&(n.parentNode&&n.parentNode.removeChild(n),this.config.show_loading=!0)}),n.ical={parse:function(n){var t=n.match(RegExp(this.c_start+"[^\f]*"+this.c_end,"")),r,u,f,i,e,o;if(t.length){for(t[0]=t[0].replace(/[\r\n]+ /g,""),t[0]=t[0].replace(/[\r\n]+(?=[a-z \t])/g," "),t[0]=t[0].replace(/\;[^:\r\n]*:/g,":"),r=[],f=RegExp("(?:"+this.e_start+")([^\f]*?)(?:"+this.e_end+")","g");(u=f.exec(t))!==null;){for(i={},o=/[^\r\n]+[\r\n]+/g;(e=o.exec(u[1]))!==null;)this.parse_param(e.toString(),i);i.uid&&!i.id&&(i.id=i.uid);r.push(i)}return r}},parse_param:function(n,t){var u=n.indexOf(":"),i,r;u!=-1&&(i=n.substr(0,u).toLowerCase(),r=n.substr(u+1).replace(/\\\,/g,",").replace(/[\r\n]+$/,""),i=="summary"?i="text":i=="dtstart"?(i="start_date",r=this.parse_date(r,0,0)):i=="dtend"&&(i="end_date",r=this.parse_date(r,0,0)),t[i]=r)},parse_date:function(t,i,r){var u=t.split("T"),f=!1;u[1]&&(i=u[1].substr(0,2),r=u[1].substr(2,2),f=!!(u[1][6]=="Z"));var e=u[0].substr(0,4),o=parseInt(u[0].substr(4,2),10)-1,s=u[0].substr(6,2);return n.config.server_utc||f?new Date(Date.UTC(e,o,s,i,r)):new Date(e,o,s,i,r)},c_start:"BEGIN:VCALENDAR",e_start:"BEGIN:VEVENT",e_end:"END:VEVENT",c_end:"END:VCALENDAR"},n._lightbox_controls={},n.formSection=function(t){var u=this.config.lightbox.sections,r=0,i;for(r;r<u.length;r++)if(u[r].name==t)break;i=u[r];n._lightbox||n.getLightbox();var e=document.getElementById(i.id),f=e.nextSibling,o={section:i,header:e,node:f,getValue:function(t){return n.form_blocks[i.type].get_value(f,t||{},i)},setValue:function(t,r){return n.form_blocks[i.type].set_value(f,t,r||{},i)}},s=n._lightbox_controls["get_"+i.type+"_control"];return s?s(o):o},n._lightbox_controls.get_template_control=function(n){return n.control=n.node,n},n._lightbox_controls.get_select_control=function(n){return n.control=n.node.getElementsByTagName("select")[0],n},n._lightbox_controls.get_textarea_control=function(n){return n.control=n.node.getElementsByTagName("textarea")[0],n},n._lightbox_controls.get_time_control=function(n){return n.control=n.node.getElementsByTagName("select"),n},n._lightbox_controls.defaults={template:{height:30},textarea:{height:200},select:{height:23},time:{height:20}},n.form_blocks={template:{render:function(t){var i=n._lightbox_controls.defaults.template,r=i?i.height:30,u=(t.height||r||30)+"px";return"<div class='dhx_cal_ltext dhx_cal_template' style='height:"+u+";'><\/div>"},set_value:function(n,t){n.innerHTML=t||""},get_value:function(n){return n.innerHTML||""},focus:function(){}},textarea:{render:function(t){var i=n._lightbox_controls.defaults.textarea,r=i?i.height:200,u=(t.height||r||"130")+"px";return"<div class='dhx_cal_ltext' style='height:"+u+";'><textarea><\/textarea><\/div>"},set_value:function(t,i){n.form_blocks.textarea._get_input(t).value=i||""},get_value:function(t){return n.form_blocks.textarea._get_input(t).value},focus:function(t){var i=n.form_blocks.textarea._get_input(t);n._focus(i,!0)},_get_input:function(n){return n.getElementsByTagName("textarea")[0]}},select:{render:function(t){for(var r=n._lightbox_controls.defaults.select,f=r?r.height:23,e=(t.height||f||"23")+"px",u="<div class='dhx_cal_ltext' style='height:"+e+";'><select style='width:100%;'>",i=0;i<t.options.length;i++)u+="<option value='"+t.options[i].key+"'>"+t.options[i].label+"<\/option>";return u+"<\/select><\/div>"},set_value:function(n,t,i,r){var u=n.firstChild;!u._dhx_onchange&&r.onchange&&(u.onchange=r.onchange,u._dhx_onchange=!0);typeof t=="undefined"&&(t=(u.options[0]||{}).value);u.value=t||""},get_value:function(n){return n.firstChild.value},focus:function(t){var i=t.firstChild;n._focus(i,!0)}},time:{render:function(t){var o,u,h,e,f,c,i,y,p,w,b,k;t.time_format||(t.time_format=["%H:%i","%d","%m","%Y"]);t._time_format_order={};var l=t.time_format,s=n.config,r=n.date.date_part(n._currentDate()),a=1440,v=0;for(n.config.limit_time_select&&(a=60*s.last_hour+1,v=60*s.first_hour,r.setHours(s.first_hour)),o="",u=0;u<l.length;u++){h=l[u];u>0&&(o+=" ");e="";f="";switch(h){case"%Y":for(e="dhx_lightbox_year_select",t._time_format_order[3]=u,c=r.getFullYear()-5,i=0;i<10;i++)f+="<option value='"+(c+i)+"'>"+(c+i)+"<\/option>";break;case"%m":for(e="dhx_lightbox_month_select",t._time_format_order[2]=u,i=0;i<12;i++)f+="<option value='"+i+"'>"+this.locale.date.month_full[i]+"<\/option>";break;case"%d":for(e="dhx_lightbox_day_select",t._time_format_order[1]=u,i=1;i<32;i++)f+="<option value='"+i+"'>"+i+"<\/option>";break;case"%H:%i":for(e="dhx_lightbox_time_select",t._time_format_order[0]=u,i=v,y=r.getDate(),t._time_values=[];i<a;)p=this.templates.time_picker(r),f+="<option value='"+i+"'>"+p+"<\/option>",t._time_values.push(i),r.setTime(r.valueOf()+this.config.time_step*6e4),w=r.getDate()!=y?1:0,i=w*1440+r.getHours()*60+r.getMinutes()}f&&(b=n._waiAria.lightboxSelectAttrString(h),k=t.readonly?"disabled='disabled'":"",o+="<select class='"+e+"' "+k+b+">"+f+"<\/select> ")}var d=n._lightbox_controls.defaults.select,g=d?d.height:23,nt=g||30;return"<div style='height:"+nt+"px;padding-top:0px;font-size:inherit;' class='dhx_section_time'>"+o+"<span style='font-weight:normal; font-size:10pt;' class=\"clearfix\"> &nbsp;&ndash;&nbsp; <\/span>"+o+"<\/div>"},set_value:function(t,i,r,u){function c(n,t,i){for(var f,c=u._time_values,r=i.getHours()*60+i.getMinutes(),o=r,s=!1,h=0;h<c.length;h++){if(f=c[h],f===r){s=!0;break}f<r&&(o=f)}n[t+e[0]].value=s?r:o;s||o||(n[t+e[0]].selectedIndex=-1);n[t+e[1]].value=i.getDate();n[t+e[2]].value=i.getMonth();n[t+e[3]].value=i.getFullYear()}var v=n.config,f=t.getElementsByTagName("select"),e=u._time_format_order,h,o,l,s,y,a;if(v.full_day&&(t._full_day||(l="<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> "+n.locale.labels.full_day+"&nbsp;<\/label><\/input>",n.config.wide_form||(l=t.previousSibling.innerHTML+l),t.previousSibling.innerHTML=l,t._full_day=!0),s=t.previousSibling.getElementsByTagName("input")[0],s.checked=n.date.time_part(r.start_date)===0&&n.date.time_part(r.end_date)===0,f[e[0]].disabled=s.checked,f[e[0]+f.length/2].disabled=s.checked,s.onclick=function(){if(s.checked){var i={};n.form_blocks.time.get_value(t,i,u);h=n.date.date_part(i.start_date);o=n.date.date_part(i.end_date);(+o==+h||+o>=+h&&(r.end_date.getHours()!==0||r.end_date.getMinutes()!==0))&&(o=n.date.add(o,1,"day"))}else h=null,o=null;f[e[0]].disabled=s.checked;f[e[0]+f.length/2].disabled=s.checked;c(f,0,h||r.start_date);c(f,4,o||r.end_date)}),v.auto_end_date&&v.event_duration)for(y=function(){h=new Date(f[e[3]].value,f[e[2]].value,f[e[1]].value,0,f[e[0]].value);o=new Date(h.getTime()+n.config.event_duration*6e4);c(f,4,o)},a=0;a<4;a++)f[a].onchange=y;c(f,0,r.start_date);c(f,4,r.end_date)},get_value:function(t,i,r){var u=t.getElementsByTagName("select"),f=r._time_format_order,e;return i.start_date=new Date(u[f[3]].value,u[f[2]].value,u[f[1]].value,0,u[f[0]].value),i.end_date=new Date(u[f[3]+4].value,u[f[2]+4].value,u[f[1]+4].value,0,u[f[0]+4].value),u[f[3]].value&&u[f[3]+4].value||(e=n.getEvent(n._lightbox_id),e&&(i.start_date=e.start_date,i.end_date=e.end_date)),i.end_date<=i.start_date&&(i.end_date=n.date.add(i.start_date,n.config.time_step,"minute")),{start_date:new Date(i.start_date),end_date:new Date(i.end_date)}},focus:function(t){n._focus(t.getElementsByTagName("select")[0])}}},n.showCover=function(n){if(n){n.style.display="block";var t=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,r=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft,i=window.innerHeight||document.documentElement.clientHeight;n.style.top=t?Math.round(t+Math.max((i-n.offsetHeight)/2,0))+"px":Math.round(Math.max((i-n.offsetHeight)/2,0)+9)+"px";n.style.left=document.documentElement.scrollWidth>document.body.offsetWidth?Math.round(r+(document.body.offsetWidth-n.offsetWidth)/2)+"px":Math.round((document.body.offsetWidth-n.offsetWidth)/2)+"px"}this.show_cover()},n.showLightbox=function(n){if(n){if(!this.callEvent("onBeforeLightbox",[n])){this._new_event&&(this._new_event=null);return}var t=this.getLightbox();this.showCover(t);this._fill_lightbox(n,t);this._waiAria.lightboxVisibleAttr(t);this.callEvent("onLightbox",[n])}},n._fill_lightbox=function(t,i){var r=this.getEvent(t),o=i.getElementsByTagName("span"),f=[],h,c,l,s,e;for(n.templates.lightbox_header?(f.push(""),h=n.templates.lightbox_header(r.start_date,r.end_date,r),f.push(h),o[1].innerHTML="",o[2].innerHTML=h):(c=this.templates.event_header(r.start_date,r.end_date,r),l=(this.templates.event_bar_text(r.start_date,r.end_date,r)||"").substr(0,70),f.push(c),f.push(l),o[1].innerHTML=c,o[2].innerHTML=l),this._waiAria.lightboxHeader(i,f.join(" ")),s=this.config.lightbox.sections,e=0;e<s.length;e++){var u=s[e],a=n._get_lightbox_section_node(u),v=this.form_blocks[u.type],y=r[u.map_to]!==undefined?r[u.map_to]:u.default_value;v.set_value.call(this,a,y,r,u);s[e].focus&&v.focus.call(this,a)}n._lightbox_id=t},n._get_lightbox_section_node=function(n){return document.getElementById(n.id).nextSibling},n._lightbox_out=function(n){for(var r,u,f,i=this.config.lightbox.sections,t=0;t<i.length;t++)r=document.getElementById(i[t].id),r=r?r.nextSibling:r,u=this.form_blocks[i[t].type],f=u.get_value.call(this,r,n,i[t]),i[t].map_to!="auto"&&(n[i[t].map_to]=f);return n},n._empty_lightbox=function(t){var r=n._lightbox_id,i=this.getEvent(r),u=this.getLightbox();this._lame_copy(i,t);this.setEvent(i.id,i);this._edit_stop_event(i,!0);this.render_view_data()},n.hide_lightbox=function(){n.endLightbox(!1,this.getLightbox())},n.hideCover=function(n){n&&(n.style.display="none");this.hide_cover()},n.hide_cover=function(){this._cover&&this._cover.parentNode.removeChild(this._cover);this._cover=null},n.show_cover=function(){if(!this._cover){this._cover=document.createElement("div");this._cover.className="dhx_cal_cover";var n=document.height!==undefined?document.height:document.body.offsetHeight,t=document.documentElement?document.documentElement.scrollHeight:0;this._cover.style.height=Math.max(n,t)+"px";document.body.appendChild(this._cover)}},n.save_lightbox=function(){var n=this._lightbox_out({},this._lame_copy(this.getEvent(this._lightbox_id)));(!this.checkEvent("onEventSave")||this.callEvent("onEventSave",[this._lightbox_id,n,this._new_event]))&&(this._empty_lightbox(n),this.hide_lightbox())},n.startLightbox=function(n,t){this._lightbox_id=n;this._custom_lightbox=!0;this._temp_lightbox=this._lightbox;this._lightbox=t;this.showCover(t)},n.endLightbox=function(t,i){var i=i||n.getLightbox(),r=n.getEvent(this._lightbox_id);r&&this._edit_stop_event(r,t);t&&n.render_view_data();this.hideCover(i);this._custom_lightbox&&(this._lightbox=this._temp_lightbox,this._custom_lightbox=!1);this._temp_lightbox=this._lightbox_id=null;this._waiAria.lightboxHiddenAttr(i);this.callEvent("onAfterLightbox",[])},n.resetLightbox=function(){n._lightbox&&!n._custom_lightbox&&n._lightbox.parentNode.removeChild(n._lightbox);n._lightbox=null},n.cancel_lightbox=function(){this.callEvent("onEventCancel",[this._lightbox_id,this._new_event]);this.hide_lightbox()},n._init_lightbox_events=function(){this.getLightbox().onclick=function(t){var i=t?t.target:event.srcElement,r,e,u,o,f;if((i.className||(i=i.previousSibling),!i||!i.className||!(n._getClassName(i).indexOf("dhx_btn_set")>-1)||(i=i.querySelector("[dhx_button]"),i))&&(r=n._getClassName(i),i&&r))switch(r){case"dhx_save_btn":n.save_lightbox();break;case"dhx_delete_btn":e=n.locale.labels.confirm_deleting;n._dhtmlx_confirm(e,n.locale.labels.title_confirm_deleting,function(){n.deleteEvent(n._lightbox_id);n._new_event=null;n.hide_lightbox()});break;case"dhx_cancel_btn":n.cancel_lightbox();break;default:i.getAttribute("dhx_button")?n.callEvent("onLightboxButton",[r,i,t]):(r.indexOf("dhx_custom_button")!=-1&&(r.indexOf("dhx_custom_button_")!=-1?(u=i.parentNode.getAttribute("index"),f=i.parentNode.parentNode):(u=i.getAttribute("index"),f=i.parentNode,i=i.firstChild)),u&&(o=n.form_blocks[n.config.lightbox.sections[u].type],o.button_click(u,i,f,f.nextSibling)))}};this.getLightbox().onkeydown=function(t){var r=t||window.event,u=t.target||t.srcElement,i=u.querySelector("[dhx_button]");i||(i=u.parentNode.querySelector(".dhx_custom_button, .dhx_readonly"));switch((t||r).keyCode){case 32:if((t||r).shiftKey)return;i&&i.click&&i.click();break;case n.keys.edit_save:if((t||r).shiftKey)return;i&&i.click?i.click():n.save_lightbox();break;case n.keys.edit_cancel:n.cancel_lightbox()}}},n.setLightboxSize=function(){var i=this._lightbox,t;i&&(t=i.childNodes[1],t.style.height="0px",t.style.height=t.scrollHeight+"px",i.style.height=t.scrollHeight+n.xy.lightbox_additional_height+"px",t.style.height=t.scrollHeight+"px")},n._init_dnd_events=function(){dhtmlxEvent(document.body,"mousemove",n._move_while_dnd);dhtmlxEvent(document.body,"mouseup",n._finish_dnd);n._init_dnd_events=function(){}},n._move_while_dnd=function(t){if(n._dnd_start_lb){document.dhx_unselectable||(document.body.className+=" dhx_unselectable",document.dhx_unselectable=!0);var i=n.getLightbox(),r=t&&t.target?[t.pageX,t.pageY]:[event.clientX,event.clientY];i.style.top=n._lb_start[1]+r[1]-n._dnd_start_lb[1]+"px";i.style.left=n._lb_start[0]+r[0]-n._dnd_start_lb[0]+"px"}},n._ready_to_dnd=function(t){var i=n.getLightbox();n._lb_start=[parseInt(i.style.left,10),parseInt(i.style.top,10)];n._dnd_start_lb=t&&t.target?[t.pageX,t.pageY]:[event.clientX,event.clientY]},n._finish_dnd=function(){n._lb_start&&(n._lb_start=n._dnd_start_lb=!1,document.body.className=document.body.className.replace(" dhx_unselectable",""),document.dhx_unselectable=!1)},n.getLightbox=function(){var i,r,s,h,e,o,c,t,l,a;if(!this._lightbox){i=document.createElement("div");i.className="dhx_cal_light";n.config.wide_form&&(i.className+=" dhx_cal_light_wide");n.form_blocks.recurring&&(i.className+=" dhx_cal_light_rec");/msie|MSIE 6/.test(navigator.userAgent)&&(i.className+=" dhx_ie6");i.style.visibility="hidden";var f=this._lightbox_template,u=this.config.buttons_left,e="";for(t=0;t<u.length;t++)e=this._waiAria.lightboxButtonAttrString(u[t]),f+="<div "+e+" class='dhx_btn_set dhx_left_btn_set "+u[t]+"_set'><div dhx_button='1' class='"+u[t]+"'><\/div><div>"+n.locale.labels[u[t]]+"<\/div><\/div>";for(u=this.config.buttons_right,t=0;t<u.length;t++)e=this._waiAria.lightboxButtonAttrString(u[t]),f+="<div "+e+" class='dhx_btn_set dhx_right_btn_set "+u[t]+"_set' style='float:right;'><div dhx_button='1' class='"+u[t]+"'><\/div><div>"+n.locale.labels[u[t]]+"<\/div><\/div>";for(f+="<\/div>",i.innerHTML=f,n.config.drag_lightbox&&(i.firstChild.onmousedown=n._ready_to_dnd,i.firstChild.onselectstart=function(){return!1},i.firstChild.style.cursor="move",n._init_dnd_events()),this._waiAria.lightboxAttr(i),document.body.insertBefore(i,document.body.firstChild),this._lightbox=i,r=this.config.lightbox.sections,f="",t=0;t<r.length;t++)(s=this.form_blocks[r[t].type],s)&&(r[t].id="area_"+this.uid(),h="",r[t].button&&(e=n._waiAria.lightboxSectionButtonAttrString(this.locale.labels["button_"+r[t].button]),h="<div "+e+" class='dhx_custom_button' index='"+t+"'><div class='dhx_custom_button_"+r[t].button+"'><\/div><div>"+this.locale.labels["button_"+r[t].button]+"<\/div><\/div>"),this.config.wide_form&&(f+="<div class='dhx_wrap_section'>"),o=this.locale.labels["section_"+r[t].name],typeof o!="string"&&(o=r[t].name),f+="<div id='"+r[t].id+"' class='dhx_cal_lsection'>"+h+"<label>"+o+"<\/label><\/div>"+s.render.call(this,r[t]),f+="<\/div>");for(c=i.getElementsByTagName("div"),t=0;t<c.length;t++)if(l=c[t],a=n._getClassName(l),a=="dhx_cal_larea"){l.innerHTML=f;break}n._bindLightboxLabels(r);this.setLightboxSize();this._init_lightbox_events(this);i.style.display="none";i.style.visibility="visible"}return this._lightbox},n._bindLightboxLabels=function(t){for(var i,e,u,s,f=0;f<t.length;f++)if(i=t[f],i.id&&document.getElementById(i.id)){for(var h=document.getElementById(i.id),o=h.querySelector("label"),r=n._get_lightbox_section_node(i);r&&!r.querySelector;)r=r.nextSibling;e=!0;r&&(u=r.querySelector("input, select, textarea"),u&&(i.inputId=u.id||"input_"+n.uid(),u.id||(u.id=i.inputId),o.setAttribute("for",i.inputId),e=!1));e&&(s=n.form_blocks[i.type],s.focus&&(o.onclick=function(t){return function(){var i=n.form_blocks[t.type],r=n._get_lightbox_section_node(t);i&&i.focus&&i.focus.call(n,r)}}(i)))}},n.attachEvent("onEventIdChange",function(n,t){this._lightbox_id==n&&(this._lightbox_id=t)}),n._lightbox_template="<div class='dhx_cal_ltitle'><span class='dhx_mark'>&nbsp;<\/span><span class='dhx_time'><\/span><span class='dhx_title'><\/span><\/div><div class='dhx_cal_larea'><\/div>",n._init_touch_events=function(){var t=this.config.touch&&(navigator.userAgent.indexOf("Mobile")!=-1||navigator.userAgent.indexOf("iPad")!=-1||navigator.userAgent.indexOf("Android")!=-1||navigator.userAgent.indexOf("Touch")!=-1)&&!window.MSStream,n;if(t&&(this.xy.scroll_width=0,this._mobile=!0),this.config.touch){n=!0;try{document.createEvent("TouchEvent")}catch(i){n=!1}n?this._touch_events(["touchmove","touchstart","touchend"],function(n){return n.touches&&n.touches.length>1?null:n.touches[0]?{target:n.target,pageX:n.touches[0].pageX,pageY:n.touches[0].pageY,clientX:n.touches[0].clientX,clientY:n.touches[0].clientY}:n},function(){return!1}):window.PointerEvent||window.navigator.pointerEnabled?this._touch_events(["pointermove","pointerdown","pointerup"],function(n){return n.pointerType=="mouse"?null:n},function(n){return!n||n.pointerType=="mouse"}):window.navigator.msPointerEnabled&&this._touch_events(["MSPointerMove","MSPointerDown","MSPointerUp"],function(n){return n.pointerType==n.MSPOINTER_TYPE_MOUSE?null:n},function(n){return!n||n.pointerType==n.MSPOINTER_TYPE_MOUSE})}},n._touch_events=function(t,i,r){function s(t,i,u){t.addEventListener(i,function(t){return n._is_lightbox_open()?!0:r(t)?void 0:u(t)},{passive:!1})}function v(t,i,r,u){var f,s,e,o;if(!t||!i)return!1;for(f=t.target;f&&f!=n._obj;)f=f.parentNode;return f!=n._obj?!1:n.matrix&&n.matrix[n.getState().mode]&&(s=n.matrix[n.getState().mode],s.scrollable)?!1:(e=Math.abs(t.pageY-i.pageY),o=Math.abs(t.pageX-i.pageX),e<u&&o>r&&(!e||o/e>3))?(t.pageX>i.pageX?n._click.dhx_cal_next_button():n._click.dhx_cal_prev_button(),!0):!1}function y(t){if(!r(t)){var u=n.getState().drag_mode,i=n.matrix?n.matrix[n._mode]:!1,f=n.render_view_data;return u=="create"&&i&&(n.render_view_data=function(){for(var e=n.getState().drag_id,t=n.getEvent(e),f=i.y_property,r=n.getEvents(t.start_date,t.end_date),u=0;u<r.length;u++)r[u][f]!=t[f]&&(r.splice(u,1),u--);t._sorder=r.length-1;t._count=r.length;this.render_data([t],n.getState().mode)}),n._on_mouse_move(t),u=="create"&&i&&(n.render_view_data=f),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,!1}}function l(t){r(t)||(n._hide_global_tip(),f&&(n._on_mouse_up(i(t||event)),n._temp_touch_block=!1),n._drag_id=null,n._drag_mode=null,n._drag_pos=null,n._pointerDragId=null,clearTimeout(c),f=h=!1,o=!0)}var p=navigator.userAgent.indexOf("Android")!=-1&&navigator.userAgent.indexOf("WebKit")!=-1,u,e,c,f,o,h,a=0;s(document.body,t[0],function(t){if(!r(t)){var s=i(t);if(s){if(f)return y(s),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,n._update_global_tip(),!1;if(e=i(t),h){if(!e){o=!0;return}(u.target!=e.target||Math.abs(u.pageX-e.pageX)>5||Math.abs(u.pageY-e.pageY)>5)&&(o=!0,clearTimeout(c))}}}});s(this._els.dhx_cal_data[0],"touchcancel",l);s(this._els.dhx_cal_data[0],"contextmenu",function(n){if(!r(n))return h?(n&&n.preventDefault&&n.preventDefault(),(n||event).cancelBubble=!0,!1):void 0});s(this._obj,t[1],function(t){var s,l;if(!r(t)){if(n._pointerDragId=t.pointerId,f=o=!1,h=!0,s=e=i(t),!s){o=!0;return}if(l=new Date,!o&&!f&&l-a<250)return n._click.dhx_cal_data(s),window.setTimeout(function(){s.type="dblclick";n._on_dbl_click(s)},50),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,n._block_next_stop=!0,!1;if(a=l,!o&&!f&&n.config.touch_drag){var v=n._locate_event(document.activeElement),y=n._locate_event(s.target),p=u?n._locate_event(u.target):null;if(v&&y&&v==y&&v!=p)return t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,n._ignore_next_click=!1,n._click.dhx_cal_data(s),u=s,!1;c=setTimeout(function(){f=!0;var t=u.target,i=n._getClassName(t);t&&i.indexOf("dhx_body")!=-1&&(t=t.previousSibling);n._on_mouse_down(u,t);n._drag_mode&&n._drag_mode!="create"&&n.for_rendered(n._drag_id,function(t,i){t.style.display="none";n._rendered.splice(i,1)});n.config.touch_tip&&n._show_global_tip();n.updateEvent(n._drag_id)},n.config.touch_drag);u=s}}});s(this._els.dhx_cal_data[0],t[2],function(t){if(!r(t))return!f&&v(u,e,200,100)&&(n._block_next_stop=!0),f&&(n._ignore_next_click=!0,setTimeout(function(){n._ignore_next_click=!1},100)),l(t),n._block_next_stop?(n._block_next_stop=!1,t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,!1):void 0});dhtmlxEvent(document.body,t[2],l)},n._show_global_tip=function(){n._hide_global_tip();var t=n._global_tip=document.createElement("div");t.className="dhx_global_tip";n._update_global_tip(1);document.body.appendChild(t)},n._update_global_tip=function(t){var u=n._global_tip,r,i;u&&(r="",n._drag_id&&!t&&(i=n.getEvent(n._drag_id),i&&(r="<div>"+(i._timed?n.templates.event_header(i.start_date,i.end_date,i):n.templates.day_date(i.start_date,i.end_date,i))+"<\/div>")),u.innerHTML=n._drag_mode=="create"||n._drag_mode=="new-size"?(n.locale.labels.drag_to_create||"Drag to create")+r:(n.locale.labels.drag_to_move||"Drag to move")+r)},n._hide_global_tip=function(){var t=n._global_tip;t&&t.parentNode&&(t.parentNode.removeChild(t),n._global_tip=0)},n._dp_init=function(t){t._methods=["_set_event_text_style","","_dp_change_event_id","_dp_hook_delete"];this._dp_change_event_id=function(t,i){n.getEvent(t)&&n.changeEventId(t,i)};this._dp_hook_delete=function(i,r){if(n.getEvent(i))return r&&i!=r&&(this.getUserData(i,t.action_param)=="true_deleted"&&this.setUserData(i,t.action_param,"updated"),this.changeEventId(i,r)),this.deleteEvent(r,!0)};this.attachEvent("onEventAdded",function(n){!this._loading&&this._validId(n)&&t.setUpdated(n,!0,"inserted")});this.attachEvent("onConfirmedBeforeEventDelete",function(n){if(this._validId(n)){var i=t.getState(n);return i=="inserted"||this._new_event?(t.setUpdated(n,!1),!0):i=="deleted"?!1:i=="true_deleted"?!0:(t.setUpdated(n,!0,"deleted"),!1)}});this.attachEvent("onEventChanged",function(n){!this._loading&&this._validId(n)&&t.setUpdated(n,!0,"updated")});n.attachEvent("onClearAll",function(){t._in_progress={};t._invalid={};t.updatedRows=[];t._waitMode=0});t._objToJson=function(n,i,r){r=r||"";i=i||{};for(var u in n)u.indexOf("_")!==0&&(n[u]&&n[u].getUTCFullYear?i[r+u]=this.obj.templates.xml_format(n[u]):n[u]&&typeof n[u]=="object"?t._objToJson(n[u],i,r+u+"."):i[r+u]=n[u]);return i};t._getRowData=function(n){var t=this.obj.getEvent(n);return this._objToJson(t)};t._clearUpdateFlag=function(){};t.attachEvent("insertCallback",n._update_callback);t.attachEvent("updateCallback",n._update_callback);t.attachEvent("deleteCallback",function(n,t){this.obj.getEvent(t)?(this.obj.setUserData(t,this.action_param,"true_deleted"),this.obj.deleteEvent(t)):this.obj._add_rec_marker&&this.obj._update_callback(n,t)})},n._validId=function(){return!0},n.setUserData=function(n,t,i){if(n){var r=this.getEvent(n);r&&(r[t]=i)}else this._userdata[t]=i},n.getUserData=function(n,t){if(n){var i=this.getEvent(n);return i?i[t]:null}return this._userdata[t]},n._set_event_text_style=function(t,i){if(n.getEvent(t)){this.for_rendered(t,function(n){n.style.cssText+=";"+i});var r=this.getEvent(t);r._text_style=i;this.event_updated(r)}},n._update_callback=function(t){var i=n._xmlNodeToJSON(t.firstChild);i.rec_type=="none"&&(i.rec_pattern="none");i.text=i.text||i._tagvalue;i.start_date=n.templates.xml_date(i.start_date);i.end_date=n.templates.xml_date(i.end_date);n.addEvent(i);n._add_rec_marker&&n.setCurrentView()},n._skin_settings={fix_tab_position:[1,0],use_select_menu_space:[1,0],wide_form:[1,0],hour_size_px:[44,42],displayed_event_color:["#ff4a4a","ffc5ab"],displayed_event_text_color:["#ffef80","7e2727"]},n._skin_xy={lightbox_additional_height:[90,50],nav_height:[59,22],bar_height:[24,20]},n._is_material_skin=function(){return(n.skin+"").indexOf("material")>-1},n._border_box_bvents=function(){return n._is_material_skin()},n._configure=function(n,t,i){for(var r in t)typeof n[r]=="undefined"&&(n[r]=t[r][i])},n._skin_init=function(){var r,i,u,t,f,e,s,o;if(!n.skin)for(r=document.getElementsByTagName("link"),i=0;i<r.length;i++)if(u=r[i].href.match("dhtmlxscheduler_([a-z]+).css"),u){n.skin=u[1];break}(t=0,n.skin&&(n.skin==="classic"||n.skin==="glossy")&&(t=1),n._is_material_skin()&&(f=n.config.buttons_left.$inital,e=n.config.buttons_right.$inital,f&&n.config.buttons_left.slice().join()==f&&e&&n.config.buttons_right.slice().join()==e&&(s=n.config.buttons_left.slice(),n.config.buttons_left=n.config.buttons_right.slice(),n.config.buttons_right=s),n.xy.event_header_height=18,n.xy.menu_width=25,n.xy.week_agenda_scale_height=35,n.xy.map_icon_width=38,n._lightbox_controls.defaults.textarea.height=64,n._lightbox_controls.defaults.time.height="auto"),this._configure(n.config,n._skin_settings,t),this._configure(n.xy,n._skin_xy,t),n.skin==="flat"&&(n.xy.scale_height=35,n.templates.hour_scale=function(n){var t=n.getMinutes();return t=t<10?"0"+t:t,"<span class='dhx_scale_h'>"+n.getHours()+"<\/span><span class='dhx_scale_m'>&nbsp;"+t+"<\/span>"}),t)||(o=n.config.minicalendar,o&&(o.padding=14),n.templates.event_bar_date=function(t){return" <b>"+n.templates.event_date(t)+"<\/b> "},n.attachEvent("onTemplatesReady",function(){var c=n.date.date_to_str("%d"),o,u,t,f;if(n.templates._old_month_day||(n.templates._old_month_day=n.templates.month_day),o=n.templates._old_month_day,n.templates.month_day=function(t){if(this._mode=="month"){var i=c(t);return t.getDate()==1&&(i=n.locale.date.month_full[t.getMonth()]+" "+i),+t==+n.date.date_part(this._currentDate())&&(i=n.locale.labels.dhx_cal_today_button+" "+i),i}return o.call(this,t)},n.config.fix_tab_position){var s=n._els.dhx_cal_navline[0].getElementsByTagName("div"),e=null,i=211,r=[14,75,136],h=14;for(n._is_material_skin()&&(r=[16,103,192],i=294,h=-1),u=0;u<s.length;u++)if(t=s[u],f=t.getAttribute("name"),f){t.style.right="auto";switch(f){case"day_tab":t.style.left=r[0]+"px";t.className+=" dhx_cal_tab_first";break;case"week_tab":t.style.left=r[1]+"px";break;case"month_tab":t.style.left=r[2]+"px";t.className+=" dhx_cal_tab_last";break;default:t.style.left=i+"px";t.className+=" dhx_cal_tab_standalone";i=i+h+t.offsetWidth}t.className+=" "+f}else(t.className||"").indexOf("dhx_minical_icon")===0&&t.parentNode==n._els.dhx_cal_navline[0]&&(e=t);e&&(e.style.left=i+"px")}}),n._skin_init=function(){})},window.jQuery&&function(n){var t=0,i=[];n.fn.dhx_scheduler=function(r){if(typeof r=="string"){if(i[r])return i[r].apply(this,[]);n.error("Method "+r+" does not exist on jQuery.dhx_scheduler")}else{var u=[];return(this.each(function(){var i,n,f;if(this&&this.getAttribute)if(this.getAttribute("dhxscheduler"))u.push(window[this.getAttribute("dhxscheduler")]);else{i="scheduler";t&&(i="scheduler"+(t+1),window[i]=Scheduler.getSchedulerInstance());n=window[i];this.setAttribute("dhxscheduler",i);for(f in r)f!="data"&&(n.config[f]=r[f]);this.getElementsByTagName("div").length||(this.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;<\/div><div class="dhx_cal_next_button">&nbsp;<\/div><div class="dhx_cal_today_button"><\/div><div class="dhx_cal_date"><\/div><div class="dhx_cal_tab" name="day_tab" style="right:204px;"><\/div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"><\/div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"><\/div><\/div><div class="dhx_cal_header"><\/div><div class="dhx_cal_data"><\/div>',this.className+=" dhx_cal_container");n.init(this,n.config.date,n.config.mode);r.data&&n.parse(r.data);u.push(n);t++}}),u.length===1)?u[0]:u}}}(jQuery),function(){function u(n,t,i){t&&(n._date=t);i&&(n._mode=i)}var f=n.setCurrentView,r=n.updateView,t=null,i=null,e=function(f,e){var o=this,s,h;window.clearTimeout(i);window.clearTimeout(t);s=o._date;h=o._mode;u(this,f,e);i=setTimeout(function(){if(!o.callEvent("onBeforeViewChange",[h,s,e||o._mode,f||o._date])){u(o,s,h);return}r.call(o,f,e);o.callEvent("onViewChange",[o._mode,o._date]);window.clearTimeout(t);i=0},n.config.delay_render)},o=function(f,e){var o=this,s=arguments;u(this,f,e);window.clearTimeout(t);t=setTimeout(function(){i||r.apply(o,s)},n.config.delay_render)};n.attachEvent("onSchedulerReady",function(){n.config.delay_render?(n.setCurrentView=e,n.updateView=o):(n.setCurrentView=f,n.updateView=r)})}(),t=0;t<Scheduler._schedulerPlugins.length;t++)Scheduler._schedulerPlugins[t](n);return n._internal_id=Scheduler._seed++,Scheduler.$syncFactory&&Scheduler.$syncFactory(n),n};window.scheduler=Scheduler.getSchedulerInstance();dhtmlx&&dhtmlx.attaches&&(dhtmlx.attaches.attachScheduler=function(n,t,i,r){var i=i||'<div class="dhx_cal_tab" name="day_tab" style="right:204px;"><\/div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"><\/div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"><\/div>',u=document.createElement("DIV");return u.id="dhxSchedObj_"+this._genStr(12),u.innerHTML='<div id="'+u.id+'" class="dhx_cal_container" style="width:100%; height:100%;"><div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;<\/div><div class="dhx_cal_next_button">&nbsp;<\/div><div class="dhx_cal_today_button"><\/div><div class="dhx_cal_date"><\/div>'+i+'<\/div><div class="dhx_cal_header"><\/div><div class="dhx_cal_data"><\/div><\/div>',document.body.appendChild(u.firstChild),this.attachObject(u.id,!1,!0),this.vs[this.av].sched=r,this.vs[this.av].schedId=u.id,r.setSizes=r.updateView,r.destructor=function(){},r.init(u.id,n,t),this.vs[this._viewRestore()].sched});
/*
@license
dhtmlxScheduler v.5.1.6 Professional
This software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.
(c) Dinamenta, UAB.
*/
Scheduler.plugin(function(n){n.config.year_x=4;n.config.year_y=3;n.xy.year_top=0;n.templates.year_date=function(t){return n.date.date_to_str(n.locale.labels.year_tab+" %Y")(t)};n.templates.year_month=n.date.date_to_str("%F");n.templates.year_scale_date=n.date.date_to_str("%D");n.templates.year_tooltip=function(n,t,i){return i.text},function(){var t=function(){return"year"==n._mode},r,u,f,e;n.dblclick_dhx_month_head=function(i){var u,e,r,f,o;if(t()){if(u=i.target||i.srcElement,e=n._getClassName(u.parentNode),-1!=e.indexOf("dhx_before")||-1!=e.indexOf("dhx_after"))return!1;for(r=u;r&&(!r.hasAttribute||!r.hasAttribute("date"));)r=r.parentNode;r&&(f=this.templates.xml_date(r.getAttribute("date")),f.setDate(parseInt(u.innerHTML,10)),o=this.date.add(f,1,"day"),!this.config.readonly&&this.config.dblclick_create&&this.addEventNow(f.valueOf(),o.valueOf(),i))}};r=n.changeEventId;n.changeEventId=function(){r.apply(this,arguments);t()&&this.year_view(!0)};var o=n.render_data,s=n.date.date_to_str("%Y/%m/%d"),i=n.date.str_to_date("%Y/%m/%d");n.render_data=function(n){if(!t())return o.apply(this,arguments);for(var i=0;i<n.length;i++)this._year_render_event(n[i])};u=n.clear_view;n.clear_view=function(){var i,r,f;if(!t())return u.apply(this,arguments);i=n._year_marked_cells;r=null;for(f in i)i.hasOwnProperty(f)&&(r=i[f],r.className="dhx_month_head",r.removeAttribute("date"));n._year_marked_cells={}};n._hideToolTip=function(){this._tooltip&&(this._tooltip.style.display="none",this._tooltip.date=new Date(9999,1,1))};n._showToolTip=function(t,i,r,u){var h,o,c,l;if(this._tooltip){if(this._tooltip.date.valueOf()==t.valueOf())return;this._tooltip.innerHTML=""}else h=this._tooltip=document.createElement("div"),h.className="dhx_year_tooltip",document.body.appendChild(h),h.onclick=n._click.dhx_cal_data;for(var e=this.getEvents(t,this.date.add(t,1,"day")),s="",f=0;f<e.length;f++)o=e[f],this.filter_event(o.id,o)&&(c=o.color?"background:"+o.color+";":"",l=o.textColor?"color:"+o.textColor+";":"",s+="<div class='dhx_tooltip_line' style='"+c+l+"' event_id='"+e[f].id+"'>",s+="<div class='dhx_tooltip_date' style='"+c+l+"'>"+(e[f]._timed?this.templates.event_date(e[f].start_date):"")+"<\/div>",s+="<div class='dhx_event_icon icon_details'>&nbsp;<\/div>",s+=this.templates.year_tooltip(e[f].start_date,e[f].end_date,e[f])+"<\/div>");this._tooltip.style.display="";this._tooltip.style.top="0px";this._tooltip.style.left=document.body.offsetWidth-i.left-this._tooltip.offsetWidth<0?i.left-this._tooltip.offsetWidth+"px":i.left+u.offsetWidth+"px";this._tooltip.date=t;this._tooltip.innerHTML=s;this._tooltip.style.top=document.body.offsetHeight-i.top-this._tooltip.offsetHeight<0?i.top-this._tooltip.offsetHeight+u.offsetHeight+"px":i.top+"px"};n._year_view_tooltip_handler=function(r){if(t()){var r=r||event,u=r.target||r.srcElement;"a"==u.tagName.toLowerCase()&&(u=u.parentNode);-1!=n._getClassName(u).indexOf("dhx_year_event")?n._showToolTip(i(u.getAttribute("date")),n.$domHelpers.getOffset(u),r,u):n._hideToolTip()}};n._init_year_tooltip=function(){n._detachDomEvent(n._els.dhx_cal_data[0],"mouseover",n._year_view_tooltip_handler);dhtmlxEvent(n._els.dhx_cal_data[0],"mouseover",n._year_view_tooltip_handler)};n._get_year_cell=function(n){var t=n.getMonth()+12*(n.getFullYear()-this._min_date.getFullYear())-this.week_starts._month,r=this._els.dhx_cal_data[0].childNodes[t],i=this.week_starts[t]+n.getDate()-1,u=r.querySelectorAll(".dhx_year_body tr")[Math.floor(i/7)],f=u.querySelectorAll("td")[i%7];return f.querySelector(".dhx_month_head")};n._year_marked_cells={};n._mark_year_date=function(t,i){var u=s(t),r=this._get_year_cell(t),f=this.templates.event_class(i.start_date,i.end_date,i);n._year_marked_cells[u]||(r.className="dhx_month_head dhx_year_event",r.setAttribute("date",u),n._year_marked_cells[u]=r);r.className+=f?" "+f:""};n._unmark_year_date=function(n){this._get_year_cell(n).className="dhx_month_head"};n._year_render_event=function(n){for(var t=n.start_date,t=t.valueOf()<this._min_date.valueOf()?this._min_date:this.date.date_part(new Date(t));t<n.end_date;)if(this._mark_year_date(t,n),t=this.date.add(t,1,"day"),t.valueOf()>=this._max_date.valueOf())return};n.year_view=function(t){var i;if(t&&(i=n.xy.scale_height,n.xy.scale_height=-1),n._els.dhx_cal_header[0].style.display=t?"none":"",n.set_sizes(),t&&(n.xy.scale_height=i),n._table_view=t,!this._load_mode||!this._load())if(t){if(n._init_year_tooltip(),n._reset_year_scale(),n._load_mode&&n._load())return void(n._render_wait=!0);n.render_view_data()}else n._hideToolTip()};n._reset_year_scale=function(){var o,e,t,h,y;this._cols=[];this._colsS={};var l=[],u=this._els.dhx_cal_data[0],f=this.config;u.scrollTop=0;u.innerHTML="";o=Math.floor(parseInt(u.style.width)/f.year_x);e=Math.floor((parseInt(u.style.height)-n.xy.year_top)/f.year_y);190>e&&(e=190,o=Math.floor((parseInt(u.style.width)-n.xy.scroll_width)/f.year_x));var p=o-11,w=0,s=document.createElement("div"),c=this.date.week_start(n._currentDate());this._process_ignores(c,7,"day",1);for(var it=7-(this._ignores_detected||0),b=0,t=0;7>t;t++)this._ignores&&this._ignores[t]||(this._cols[t]=Math.floor(p/(it-b)),this._render_x_header(t,w,c,s),p-=this._cols[t],w+=this._cols[t],b++),c=this.date.add(c,1,"day");for(s.lastChild.className+=" dhx_scale_bar_last",t=0;t<s.childNodes.length;t++)this._waiAria.yearHeadCell(s.childNodes[t]);for(var r=this.date[this._mode+"_start"](this.date.copy(this._date)),a=r,i=null,t=0;t<f.year_y;t++)for(h=0;h<f.year_x;h++){i=document.createElement("div");i.className="dhx_year_box";i.style.cssText="position:absolute;";i.setAttribute("date",this.templates.xml_format(r));i.innerHTML="<div class='dhx_year_month'><\/div><div class='dhx_year_grid'><div class='dhx_year_week'>"+s.innerHTML+"<\/div><div class='dhx_year_body'><\/div><\/div>";var k=i.querySelector(".dhx_year_month"),rt=i.querySelector(".dhx_year_grid"),d=i.querySelector(".dhx_year_week"),g=i.querySelector(".dhx_year_body"),nt=n.uid();this._waiAria.yearHeader(k,nt);this._waiAria.yearGrid(rt,nt);k.innerHTML=this.templates.year_month(r);for(var ut=this.date.week_start(r),tt=(this._reset_month_scale(g,r,ut,6),g.querySelectorAll("td")),v=0;v<tt.length;v++)this._waiAria.yearDayCell(tt[v]);u.appendChild(i);d.style.height=d.childNodes[0].offsetHeight+"px";y=Math.round((e-190)/2);i.style.marginTop=y+"px";this.set_xy(i,o-10,e-y-10,o*h+5,e*t+5+n.xy.year_top);l[t*f.year_x+h]=(r.getDay()-(this.config.start_on_monday?1:0)+7)%7;r=this.date.add(r,1,"month")}this._els.dhx_cal_date[0].innerHTML=this.templates[this._mode+"_date"](a,r,this._mode);this.week_starts=l;l._month=a.getMonth();this._min_date=a;this._max_date=r};f=n.getActionData;n.getActionData=function(i){if(!t())return f.apply(n,arguments);var e=i?i.target:event.srcElement,r=n._get_year_month_date(e),o=n._get_year_month_cell(e),u=n._get_year_day_indexes(o);return u&&r?(r=n.date.add(r,u.week,"week"),r=n.date.add(r,u.day,"day")):r=null,{date:r,section:null}};n._get_year_day_indexes=function(t){var u=n._get_year_el_node(t,this._locate_year_month_table);if(!u)return null;for(var i=0,r=0,i=0,f=u.rows.length;f>i;i++){for(var e=u.rows[i].getElementsByTagName("td"),r=0,o=e.length;o>r&&e[r]!=t;r++);if(o>r)break}return f>i?{day:r,week:i}:null};n._get_year_month_date=function(t){var t=n._get_year_el_node(t,n._locate_year_month_root),r;return t?(r=t.getAttribute("date"),r?n.date.week_start(n.date.month_start(i(r))):null):null};n._locate_year_month_day=function(t){return-1!=n._getClassName(t).indexOf("dhx_year_event")&&t.hasAttribute&&t.hasAttribute("date")};e=n._locate_event;n._locate_event=function(t){var u=e.apply(n,arguments),r,f,o;if(!u){if((r=n._get_year_el_node(t,n._locate_year_month_day),!r||!r.hasAttribute("date"))||(f=i(r.getAttribute("date")),o=n.getEvents(f,n.date.add(f,1,"day")),!o.length))return null;u=o[0].id}return u};n._locate_year_month_cell=function(n){return"td"==n.nodeName.toLowerCase()};n._locate_year_month_table=function(n){return"table"==n.nodeName.toLowerCase()};n._locate_year_month_root=function(n){return n.hasAttribute&&n.hasAttribute("date")};n._get_year_month_cell=function(n){return this._get_year_el_node(n,this._locate_year_month_cell)};n._get_year_month_table=function(n){return this._get_year_el_node(n,this._locate_year_month_table)};n._get_year_month_root=function(n){return this._get_year_el_node(this._get_year_month_table(n),this._locate_year_month_root)};n._get_year_el_node=function(n,t){for(;n&&!t(n);)n=n.parentNode;return n}}()});
/*
@license
dhtmlxScheduler v.5.1.6 Professional
This software is covered by DHTMLX Enterprise License. Usage without proper license is prohibited.
(c) Dinamenta, UAB.
*/
Scheduler.plugin(function(n){n.config.occurrence_timestamp_in_utc=!1;n.config.recurring_workdays=[1,2,3,4,5];n.form_blocks.recurring={_get_node:function(n){return"string"==typeof n&&(n=document.getElementById(n)),"none"==n.style.display&&(n.style.display=""),n},_outer_html:function(n){function t(n){var i,t=document.createElement("div");return t.appendChild(n.cloneNode(!0)),i=t.innerHTML,t=null,i}return n.outerHTML||t(n)},render:function(t){if(t.form){var i=n.form_blocks.recurring,r=i._get_node(t.form),u=i._outer_html(r);return r.style.display="none",u}return n.__recurring_template},_ds:{},_get_form_node:function(n,t,i){var r=n[t],u;if(!r)return null;if(r.nodeName)return r;if(r.length)for(u=0;u<r.length;u++)if(r[u].value==i)return r[u]},_get_node_value:function(n,t,i){var r=n[t],f,u;if(!r)return"";if(r.length){if(i){for(f=[],u=0;u<r.length;u++)r[u].checked&&f.push(r[u].value);return f}for(u=0;u<r.length;u++)if(r[u].checked)return r[u].value}if(r.value)return i?[r.value]:r.value},_get_node_numeric_value:function(t,i){var r=n.form_blocks.recurring._get_node_value(t,i);return 1*r||0},_set_node_value:function(n,t,i){var r=n[t],f,u;if(r)if(r.name==t)r.value=i;else if(r.length)for(f="object"==typeof i,u=0;u<r.length;u++)(f||r[u].value==i)&&(r[u].checked=f?!!i[r[u].value]:!!i)},_init_set_value:function(t,i,r){function l(n){for(var t,r,i=0;i<n.length;i++)t=n[i],t.name&&(u[t.name]?u[t.name].nodeType?(r=u[t.name],u[t.name]=[r,t]):u[t.name].push(t):u[t.name]=t)}function a(){f("dhx_repeat_day").style.display="none";f("dhx_repeat_week").style.display="none";f("dhx_repeat_month").style.display="none";f("dhx_repeat_year").style.display="none";f("dhx_repeat_"+this.value).style.display="block";n.setLightboxSize()}function b(t){var i=[c(u,"repeat")],r,f,e;for(p[i[0]](i,t);i.length<5;)i.push("");return r="",f=k(u),"no"==f?(t.end=new Date(9999,1,1),r="no"):"date_of_end"==f?t.end=tt(c(u,"date_of_end")):(n.transpose_type(i.join("_")),r=Math.max(1,c(u,"occurences_count")),e=0,t.end=n.date.add(new Date(t.start),r+e,i.join("_"))),i.join("_")+"#"+r}function k(n){var i=n.end,t;if(i.length){for(t=0;t<i.length;t++)if(i[t].checked)return i[t].value&&"on"!=i[t].value?i[t].value:t?2==t?"date_of_end":"occurences_count":"no"}else if(i.value)return i.value;return"no"}function h(n,t){var i=n.end,f,r,u;if(i.length)if(f=!!i[0].value&&"on"!=i[0].value,f)for(r=0;r<i.length;r++)i[r].value==t&&(i[r].checked=!0);else{u=0;switch(t){case"no":u=0;break;case"date_of_end":u=2;break;default:u=1}i[u].checked=!0}else i.value=t}function d(t,i){var e=n.form_blocks.recurring._set_node_value,o=t.split("#"),f,r;switch(t=o[0].split("_"),w[t[0]](t,i),o[1]){case"no":h(u,"no");break;case"":h(u,"date_of_end");f=i.end;n.config.include_end_by&&(f=n.date.add(f,-1,"day"));e(u,"date_of_end",it(f));break;default:h(u,"occurences_count");e(u,"occurences_count",o[1])}e(u,"repeat",t[0]);r=n.form_blocks.recurring._get_form_node(u,"repeat",t[0]);"SELECT"==r.nodeName&&r.onchange?r.onchange():r.onclick&&r.onclick()}var v=n.form_blocks.recurring,c=v._get_node_value,g=v._set_node_value,y,f,p,w,s,e;n.form_blocks.recurring._ds={start:r.start_date,end:r._end_date};var nt=n.date.str_to_date(n.config.repeat_date),tt=function(t){var i=nt(t);return n.config.include_end_by&&(i=n.date.add(i,1,"day")),i},it=n.date.date_to_str(n.config.repeat_date),o=t.getElementsByTagName("FORM")[0],u={};for((l(o.getElementsByTagName("INPUT")),l(o.getElementsByTagName("SELECT")),n.config.repeat_date_of_end)||(y=n.date.date_to_str(n.config.repeat_date),n.config.repeat_date_of_end=y(n.date.add(n._currentDate(),30,"day"))),g(u,"date_of_end",n.config.repeat_date_of_end),f=function(n){return document.getElementById(n)||{style:{}}},n.form_blocks.recurring._get_repeat_code=b,p={month:function(t,i){var r=n.form_blocks.recurring._get_node_value,f=n.form_blocks.recurring._get_node_numeric_value;"d"==r(u,"month_type")?(t.push(Math.max(1,f(u,"month_count"))),i.start.setDate(r(u,"month_day"))):(t.push(Math.max(1,f(u,"month_count2"))),t.push(r(u,"month_day2")),t.push(Math.max(1,f(u,"month_week2"))),n.config.repeat_precise||i.start.setDate(1));i._start=!0},week:function(t,i){var h=n.form_blocks.recurring._get_node_value,c=n.form_blocks.recurring._get_node_numeric_value;t.push(Math.max(1,c(u,"week_count")));t.push("");t.push("");for(var r=[],o=h(u,"week_day",!0),s=i.start.getDay(),f=!1,e=0;e<o.length;e++)r.push(o[e]),f=f||o[e]==s;r.length||(r.push(s),f=!0);r.sort();n.config.repeat_precise?f||(n.transpose_day_week(i.start,r,1,7),i._start=!0):(i.start=n.date.week_start(i.start),i._start=!0);t.push(r.join(","))},day:function(t){var i=n.form_blocks.recurring._get_node_value,r=n.form_blocks.recurring._get_node_numeric_value;"d"==i(u,"day_type")?t.push(Math.max(1,r(u,"day_count"))):(t.push("week"),t.push(1),t.push(""),t.push(""),t.push(n.config.recurring_workdays.join(",")),t.splice(0,1))},year:function(t,i){var r=n.form_blocks.recurring._get_node_value;"d"==r(u,"year_type")?(t.push("1"),i.start.setMonth(0),i.start.setDate(r(u,"year_day")),i.start.setMonth(r(u,"year_month"))):(t.push("1"),t.push(r(u,"year_day2")),t.push(r(u,"year_week2")),i.start.setDate(1),i.start.setMonth(r(u,"year_month2")));i._start=!0}},w={week:function(t){var r=n.form_blocks.recurring._set_node_value;r(u,"week_count",t[1]);for(var f=t[4].split(","),e={},i=0;i<f.length;i++)e[f[i]]=!0;r(u,"week_day",e)},month:function(t,i){var r=n.form_blocks.recurring._set_node_value;""===t[2]?(r(u,"month_type","d"),r(u,"month_count",t[1]),r(u,"month_day",i.start.getDate())):(r(u,"month_type","w"),r(u,"month_count2",t[1]),r(u,"month_week2",t[3]),r(u,"month_day2",t[2]))},day:function(t){var i=n.form_blocks.recurring._set_node_value;i(u,"day_type","d");i(u,"day_count",t[1])},year:function(t,i){var r=n.form_blocks.recurring._set_node_value;""===t[2]?(r(u,"year_type","d"),r(u,"year_day",i.start.getDate()),r(u,"year_month",i.start.getMonth())):(r(u,"year_type","w"),r(u,"year_week2",t[3]),r(u,"year_day2",t[2]),r(u,"year_month2",i.start.getMonth()))}},n.form_blocks.recurring._set_repeat_code=d,s=0;s<o.elements.length;s++){e=o.elements[s];switch(e.name){case"repeat":"SELECT"==e.nodeName?e.onchange=a:e.onclick=a}}n._lightbox._rec_init_done=!0},set_value:function(t,i,r){var u=n.form_blocks.recurring,f;n._lightbox._rec_init_done||u._init_set_value(t,i,r);t.open=!r.rec_type;t.blocked=this._is_modified_occurence(r);f=u._ds;f.start=r.start_date;f.end=r._end_date;u._toggle_block();i&&u._set_repeat_code(i,f)},get_value:function(t,i){if(t.open){var r=n.form_blocks.recurring._ds,u={};this.formSection("time").getValue(u);r.start=u.start_date;i.rec_type=n.form_blocks.recurring._get_repeat_code(r);r._start?(i.start_date=new Date(r.start),i._start_date=new Date(r.start),r._start=!1):i._start_date=null;i._end_date=r.end;i.rec_pattern=i.rec_type.split("#")[0]}else i.rec_type=i.rec_pattern="",i._end_date=i.end_date;return i.rec_type},_get_button:function(){var t=n.formSection("recurring").header;return t.firstChild.firstChild},_get_form:function(){return n.formSection("recurring").node},open:function(){var t=n.form_blocks.recurring,i=t._get_form();i.open||t._toggle_block()},close:function(){var t=n.form_blocks.recurring,i=t._get_form();i.open&&t._toggle_block()},_toggle_block:function(){var r=n.form_blocks.recurring,t=r._get_form(),i=r._get_button();t.open||t.blocked?(t.style.height="0px",i&&(i.style.backgroundPosition="-5px 20px",i.nextSibling.innerHTML=n.locale.labels.button_recurring)):(t.style.height="auto",i&&(i.style.backgroundPosition="-5px 0px",i.nextSibling.innerHTML=n.locale.labels.button_recurring_open));t.open=!t.open;n.setLightboxSize()},focus:function(){},button_click:function(t,i,r,u){var f=n.form_blocks.recurring,u=f._get_form();u.blocked||n.form_blocks.recurring._toggle_block()}};n._rec_markers={};n._rec_markers_pull={};n._add_rec_marker=function(n,t){n._pid_time=t;this._rec_markers[n.id]=n;this._rec_markers_pull[n.event_pid]||(this._rec_markers_pull[n.event_pid]={});this._rec_markers_pull[n.event_pid][t]=n};n._get_rec_marker=function(n,t){var i=this._rec_markers_pull[t];return i?i[n]:null};n._get_rec_markers=function(n){return this._rec_markers_pull[n]||[]};n._rec_temp=[],function(){var t=n.addEvent;n.addEvent=function(){var r=t.apply(this,arguments),i;return r&&n.getEvent(r)&&(i=n.getEvent(r),this._is_modified_occurence(i)&&n._add_rec_marker(i,1e3*i.event_length),i.rec_type&&(i.rec_pattern=i.rec_type.split("#")[0])),r}}();n.attachEvent("onEventIdChange",function(t,i){var u,r,f;if(!this._ignore_call){for(this._ignore_call=!0,n._rec_markers[t]&&(n._rec_markers[i]=n._rec_markers[t],delete n._rec_markers[t]),n._rec_markers_pull[t]&&(n._rec_markers_pull[i]=n._rec_markers_pull[t],delete n._rec_markers_pull[t]),u=0;u<this._rec_temp.length;u++)r=this._rec_temp[u],r.event_pid==t&&(r.event_pid=i,this.changeEventId(r.id,i+"#"+r.id.split("#")[1]));for(u in this._rec_markers)r=this._rec_markers[u],r.event_pid==t&&(r.event_pid=i,r._pid_changed=!0);f=n._rec_markers[i];f&&f._pid_changed&&(delete f._pid_changed,setTimeout(function(){n.callEvent("onEventChanged",[i,n.getEvent(i)])},1));delete this._ignore_call}});n.attachEvent("onConfirmedBeforeEventDelete",function(n){var t=this.getEvent(n),u,r,f;if(this._is_virtual_event(n)||this._is_modified_occurence(t)&&t.rec_type&&"none"!=t.rec_type){n=n.split("#");var e=this.uid(),o=n[1]?n[1]:t._pid_time/1e3,i=this._copy_event(t);i.id=e;i.event_pid=t.event_pid||n[0];u=o;i.event_length=u;i.rec_type=i.rec_pattern="none";this.addEvent(i);this._add_rec_marker(i,1e3*u)}else{t.rec_type&&this._lightbox_id&&this._roll_back_dates(t);r=this._get_rec_markers(n);for(f in r)r.hasOwnProperty(f)&&(n=r[f].id,this.getEvent(n)&&this.deleteEvent(n,!0))}return!0});n.attachEvent("onEventDeleted",function(t,i){!this._is_virtual_event(t)&&this._is_modified_occurence(i)&&(n._events[t]||(i.rec_type=i.rec_pattern="none",this.setEvent(t,i)))});n.attachEvent("onEventChanged",function(n,t){var e,n,h,i,o,r,u,s,f;if(this._loading)return!0;if(e=this.getEvent(n),this._is_virtual_event(n))n=n.split("#"),h=this.uid(),this._not_render=!0,i=this._copy_event(t),i.id=h,i.event_pid=n[0],o=n[1],i.event_length=o,i.rec_type=i.rec_pattern="",this._add_rec_marker(i,1e3*o),this.addEvent(i),this._not_render=!1;else{e.rec_type&&this._lightbox_id&&this._roll_back_dates(e);r=this._get_rec_markers(n);for(u in r)r.hasOwnProperty(u)&&(delete this._rec_markers[r[u].id],this.deleteEvent(r[u].id,!0));for(delete this._rec_markers_pull[n],s=!1,f=0;f<this._rendered.length;f++)this._rendered[f].getAttribute("event_id")==n&&(s=!0);s||(this._select_id=null)}return!0});n.attachEvent("onEventAdded",function(n){if(!this._loading){var t=this.getEvent(n);t.rec_type&&!t.event_length&&this._roll_back_dates(t)}return!0});n.attachEvent("onEventSave",function(n,t){var i=this.getEvent(n);return i.rec_type||!t.rec_type||this._is_virtual_event(n)||(this._select_id=null),!0});n.attachEvent("onEventCreated",function(n){var t=this.getEvent(n);return t.rec_type||(t.rec_type=t.rec_pattern=t.event_length=t.event_pid=""),!0});n.attachEvent("onEventCancel",function(n){var t=this.getEvent(n);t.rec_type&&(this._roll_back_dates(t),this.render_view_data())});n._roll_back_dates=function(n){n.event_length=(n.end_date.valueOf()-n.start_date.valueOf())/1e3;n.end_date=n._end_date;n._start_date&&(n.start_date.setMonth(0),n.start_date.setDate(n._start_date.getDate()),n.start_date.setMonth(n._start_date.getMonth()),n.start_date.setFullYear(n._start_date.getFullYear()))};n._is_virtual_event=function(n){return-1!=n.toString().indexOf("#")};n._is_modified_occurence=function(n){return n.event_pid&&"0"!=n.event_pid};n._validId=function(n){return!this._is_virtual_event(n)};n.showLightbox_rec=n.showLightbox;n.showLightbox=function(t){var r=this.locale,f=n.config.lightbox_recurring,e=this.getEvent(t),i=e.event_pid,o=this._is_virtual_event(t),u,s;if(o&&(i=t.split("#")[0]),u=function(t){var i=n.getEvent(t);return i._end_date=i.end_date,i.end_date=new Date(i.start_date.valueOf()+1e3*i.event_length),n.showLightbox_rec(t)},(i||1*i==0)&&e.rec_type)return u(t);if(!i||"0"===i||!r.labels.confirm_recurring||"instance"==f||"series"==f&&!o)return this.showLightbox_rec(t);"ask"==f?(s=this,dhtmlx.modalbox({text:r.labels.confirm_recurring,title:r.labels.title_confirm_recurring,width:"500px",position:"middle",buttons:[r.labels.button_edit_series,r.labels.button_edit_occurrence,r.labels.icon_cancel],callback:function(n){switch(+n){case 0:return u(i);case 1:return s.showLightbox_rec(t);case 2:return}}})):u(i)};n.get_visible_events_rec=n.get_visible_events;n.get_visible_events=function(n){for(var t=0;t<this._rec_temp.length;t++)delete this._events[this._rec_temp[t].id];this._rec_temp=[];for(var i=this.get_visible_events_rec(n),r=[],t=0;t<i.length;t++)i[t].rec_type?"none"!=i[t].rec_pattern&&this.repeat_date(i[t],r):r.push(i[t]);return r},function(){var i=n.isOneDayEvent,t;n.isOneDayEvent=function(n){return n.rec_type?!0:i.call(this,n)};t=n.updateEvent;n.updateEvent=function(i){var r=n.getEvent(i);r&&r.rec_type&&(r.rec_pattern=(r.rec_type||"").split("#")[0]);r&&r.rec_type&&!this._is_virtual_event(i)?n.update_view():t.call(this,i)}}();n.transponse_size={day:1,week:7,month:1,year:12};n.date.day_week=function(n,t,i){n.setDate(1);i=7*(i-1);var u=n.getDay(),r=1*t+i-u+1;n.setDate(i>=r?r+7:r)};n.transpose_day_week=function(t,i,r,u,f){for(var o=(t.getDay()||(n.config.start_on_monday?7:0))-r,e=0;e<i.length;e++)if(i[e]>o)return t.setDate(t.getDate()+1*i[e]-o-(u?r:f));this.transpose_day_week(t,i,r+u,null,r)};n.transpose_type=function(t){var e="transpose_"+t,r,f;if(!this.date[e]){var i=t.split("_"),s=864e5,o="add_"+t,u=this.transponse_size[i[0]]*i[1];if("day"==i[0]||"week"==i[0]){if(r=null,i[4]&&(r=i[4].split(","),n.config.start_on_monday)){for(f=0;f<r.length;f++)r[f]=1*r[f]||7;r.sort()}this.date[e]=function(t,i){var f=Math.floor((i.valueOf()-t.valueOf())/(s*u));f>0&&t.setDate(t.getDate()+f*u);r&&n.transpose_day_week(t,r,1,u)};this.date[o]=function(t,i){var f=new Date(t.valueOf()),e;if(r)for(e=0;i>e;e++)n.transpose_day_week(f,r,0,u);else f.setDate(f.getDate()+i*u);return f}}else("month"==i[0]||"year"==i[0])&&(this.date[e]=function(t,r){var f=Math.ceil((12*r.getFullYear()+1*r.getMonth()+1-(12*t.getFullYear()+1*t.getMonth()+1))/u-1);f>=0&&t.setMonth(t.getMonth()+f*u);i[3]&&n.date.day_week(t,i[2],i[3])},this.date[o]=function(t,r){var f=new Date(t.valueOf());return f.setMonth(f.getMonth()+r*u),i[3]&&n.date.day_week(f,i[2],i[3]),f})}};n.repeat_date=function(t,i,r,u,f,e){var l,h,v,s;u=u||this._min_date;f=f||this._max_date;var a=e||-1,o=new Date(t.start_date.valueOf()),y=o.getHours(),c=0;for(!t.rec_pattern&&t.rec_type&&(t.rec_pattern=t.rec_type.split("#")[0]),this.transpose_type(t.rec_pattern),n.date["transpose_"+t.rec_pattern](o,u);o<t.start_date||n._fix_daylight_saving_date(o,u,t,o,new Date(o.valueOf()+1e3*t.event_length)).valueOf()<=u.valueOf()||o.valueOf()+1e3*t.event_length<=u.valueOf();)o=this.date.add(o,1,t.rec_pattern);for(;f>o&&o<t.end_date&&(0>a||a>c);){if(o.setHours(y),l=n.config.occurrence_timestamp_in_utc?Date.UTC(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds()):o.valueOf(),h=this._get_rec_marker(l,t.id),h)r&&("none"!=h.rec_type&&c++,i.push(h));else{if(v=new Date(o.valueOf()+1e3*t.event_length),s=this._copy_event(t),s.text=t.text,s.start_date=o,s.event_pid=t.id,s.id=t.id+"#"+Math.ceil(l/1e3),s.end_date=v,s.end_date=n._fix_daylight_saving_date(s.start_date,s.end_date,t,o,s.end_date),s._timed=this.isOneDayEvent(s),!s._timed&&!this._table_view&&!this.config.multi_day)return;i.push(s);r||(this._events[s.id]=s,this._rec_temp.push(s));c++}o=this.date.add(o,1,t.rec_pattern)}};n._fix_daylight_saving_date=function(n,t,i,r,u){var f=n.getTimezoneOffset()-t.getTimezoneOffset();return f?f>0?new Date(r.valueOf()+1e3*i.event_length-6e4*f):new Date(t.valueOf()-6e4*f):new Date(u.valueOf())};n.getRecDates=function(t,i){var r="object"==typeof t?t:n.getEvent(t),f=[],e,u;if(i=i||100,!r.rec_type)return[{start_date:r.start_date,end_date:r.end_date}];if("none"==r.rec_type)return[];for(n.repeat_date(r,f,!0,r.start_date,r.end_date,i),e=[],u=0;u<f.length;u++)"none"!=f[u].rec_type&&e.push({start_date:f[u].start_date,end_date:f[u].end_date});return e};n.getEvents=function(n,t){var f=[],e,i,r,u;for(e in this._events)if(i=this._events[e],i&&i.start_date<t&&i.end_date>n)if(i.rec_pattern){if("none"==i.rec_pattern)continue;for(r=[],this.repeat_date(i,r,!0,n,t),u=0;u<r.length;u++)!r[u].rec_pattern&&r[u].start_date<t&&r[u].end_date>n&&!this._rec_markers[r[u].id]&&f.push(r[u])}else this._is_virtual_event(i.id)||f.push(i);return f};n.config.repeat_date="%m.%d.%Y";n.config.lightbox.sections=[{name:"description",map_to:"text",type:"textarea",focus:!0},{name:"recurring",type:"recurring",map_to:"rec_type",button:"recurring"},{name:"time",height:72,type:"time",map_to:"auto"}];n._copy_dummy=function(){var n=new Date(this.start_date),t=new Date(this.end_date);this.start_date=n;this.end_date=t;this.event_length=this.event_pid=this.rec_pattern=this.rec_type=null};n.config.include_end_by=!1;n.config.lightbox_recurring="ask";n.attachEvent("onClearAll",function(){n._rec_markers={};n._rec_markers_pull={};n._rec_temp=[]});n.__recurring_template='<div class="dhx_form_repeat"> <form> <div class="dhx_repeat_left"> <label><input class="dhx_repeat_radio" type="radio" name="repeat" value="day" />Daily<\/label><br /> <label><input class="dhx_repeat_radio" type="radio" name="repeat" value="week"/>Weekly<\/label><br /> <label><input class="dhx_repeat_radio" type="radio" name="repeat" value="month" checked />Monthly<\/label><br /> <label><input class="dhx_repeat_radio" type="radio" name="repeat" value="year" />Yearly<\/label> <\/div> <div class="dhx_repeat_divider"><\/div> <div class="dhx_repeat_center"> <div style="display:none;" id="dhx_repeat_day"> <label><input class="dhx_repeat_radio" type="radio" name="day_type" value="d"/>Every<\/label><input class="dhx_repeat_text" type="text" name="day_count" value="1" />day<br /> <label><input class="dhx_repeat_radio" type="radio" name="day_type" checked value="w"/>Every workday<\/label> <\/div> <div style="display:none;" id="dhx_repeat_week"> Repeat every<input class="dhx_repeat_text" type="text" name="week_count" value="1" />week next days:<br /> <table class="dhx_repeat_days"> <tr> <td> <label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="1" />Monday<\/label><br /> <label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="4" />Thursday<\/label> <\/td> <td> <label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="2" />Tuesday<\/label><br /> <label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="5" />Friday<\/label> <\/td> <td> <label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="3" />Wednesday<\/label><br /> <label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="6" />Saturday<\/label> <\/td> <td> <label><input class="dhx_repeat_checkbox" type="checkbox" name="week_day" value="0" />Sunday<\/label><br /><br /> <\/td> <\/tr> <\/table> <\/div> <div id="dhx_repeat_month"> <label><input class="dhx_repeat_radio" type="radio" name="month_type" value="d"/>Repeat<\/label><input class="dhx_repeat_text" type="text" name="month_day" value="1" />day every<input class="dhx_repeat_text" type="text" name="month_count" value="1" />month<br /> <label><input class="dhx_repeat_radio" type="radio" name="month_type" checked value="w"/>On<\/label><input class="dhx_repeat_text" type="text" name="month_week2" value="1" /><select name="month_day2"><option value="1" selected >Monday<option value="2">Tuesday<option value="3">Wednesday<option value="4">Thursday<option value="5">Friday<option value="6">Saturday<option value="0">Sunday<\/select>every<input class="dhx_repeat_text" type="text" name="month_count2" value="1" />month<br /> <\/div> <div style="display:none;" id="dhx_repeat_year"> <label><input class="dhx_repeat_radio" type="radio" name="year_type" value="d"/>Every<\/label><input class="dhx_repeat_text" type="text" name="year_day" value="1" />day<select name="year_month"><option value="0" selected >January<option value="1">February<option value="2">March<option value="3">April<option value="4">May<option value="5">June<option value="6">July<option value="7">August<option value="8">September<option value="9">October<option value="10">November<option value="11">December<\/select>month<br /> <label><input class="dhx_repeat_radio" type="radio" name="year_type" checked value="w"/>On<\/label><input class="dhx_repeat_text" type="text" name="year_week2" value="1" /><select name="year_day2"><option value="1" selected >Monday<option value="2">Tuesday<option value="3">Wednesday<option value="4">Thursday<option value="5">Friday<option value="6">Saturday<option value="7">Sunday<\/select>of<select name="year_month2"><option value="0" selected >January<option value="1">February<option value="2">March<option value="3">April<option value="4">May<option value="5">June<option value="6">July<option value="7">August<option value="8">September<option value="9">October<option value="10">November<option value="11">December<\/select><br /> <\/div> <\/div> <div class="dhx_repeat_divider"><\/div> <div class="dhx_repeat_right"> <label><input class="dhx_repeat_radio" type="radio" name="end" checked/>No end date<\/label><br /> <label><input class="dhx_repeat_radio" type="radio" name="end" />After<\/label><input class="dhx_repeat_text" type="text" name="occurences_count" value="1" />occurrences<br /> <label><input class="dhx_repeat_radio" type="radio" name="end" />End by<\/label><input class="dhx_repeat_date" type="text" name="date_of_end" value="'+n.config.repeat_date_of_end+'" /><br /> <\/div> <\/form> <\/div> <div style="clear:both"> <\/div>'});
//# sourceMappingURL=bundle--scheduler.min.js.map